/*
 * Copyright 2016 The BigDL Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.intel.analytics.bigdl.nn

import com.intel.analytics.bigdl.tensor.Tensor
import com.intel.analytics.bigdl.utils.{T, Table}
import org.scalatest.{FlatSpec, Matchers}

class MaskRCNNFPNFeatureExtractorSpec extends FlatSpec with Matchers {
  "MaskRCNNFPNFeatureExtractor" should "be ok" in {
    val resolution = 14
    val scales = Array[Float](0.25f, 0.125f, 0.0625f, 0.03125f)
    val sampling_ratio = 2
    val in_channels = 6
    val use_gn = false
    val layers = Array[Int](4, 4, 4, 4)
    val dilation = 1

    val layer = new MaskRCNNFPNFeatureExtractor(in_channels, resolution, scales,
      sampling_ratio, layers, dilation, use_gn)

    val paramsTable = layer.getParametersTable()
    for (i <- paramsTable.keySet) {
      val params = paramsTable.get[Table](i).get.get[Tensor[Float]]("weight").get
      params.fill(0.01f)
    }

    val input = Tensor[Float](T(T(T(
      T(7.5763e-01, 2.7931e-01, 4.0307e-01, 7.3468e-01, 2.9282e-02,
      7.9986e-01, 3.9714e-01, 7.5437e-01, 5.6951e-01, 4.3878e-01,
      6.3868e-01, 5.2467e-01, 6.8261e-01, 3.0515e-01),
      T(4.6355e-01, 4.5499e-01, 5.7247e-01, 4.9800e-01, 9.3708e-01,
        6.5560e-01, 3.1380e-01, 1.9802e-01, 4.1619e-01, 2.8433e-01,
        3.3978e-01, 5.2394e-01, 7.9806e-01, 7.7177e-01),
      T(1.1225e-02, 8.0996e-01, 6.3968e-01, 9.7428e-01, 8.3003e-01,
        4.4431e-02, 2.4596e-02, 2.5883e-01, 9.3906e-01, 4.1672e-01,
        7.1398e-01, 2.6764e-01, 9.9061e-01, 2.8845e-01),
      T(8.7496e-01, 5.0592e-01, 2.3659e-01, 7.5701e-01, 2.3459e-01,
        6.4705e-01, 3.5562e-01, 4.4518e-01, 1.9306e-02, 2.6161e-01,
        7.7132e-01, 3.7846e-01, 9.9802e-01, 9.0079e-01),
      T(4.7659e-01, 1.6626e-01, 8.0448e-01, 6.5518e-01, 1.7679e-01,
        8.2477e-01, 8.0355e-01, 9.4345e-01, 2.1972e-01, 4.1770e-01,
        4.9031e-01, 5.7303e-01, 1.2054e-01, 1.4519e-01),
      T(7.7200e-01, 3.8275e-01, 7.4424e-01, 5.2850e-01, 6.6417e-01,
        6.0994e-01, 6.8180e-01, 7.4786e-01, 3.6944e-02, 7.5168e-01,
        1.4844e-01, 1.2275e-01, 5.3041e-01, 4.1480e-01),
      T(7.9366e-01, 2.1043e-01, 5.5509e-02, 8.6388e-01, 4.2586e-01,
        7.8123e-01, 6.6074e-01, 1.2506e-01, 6.0045e-01, 6.2010e-01,
        1.6522e-01, 2.6276e-01, 6.7049e-01, 5.8956e-01),
      T(2.8731e-01, 3.4864e-01, 9.5794e-01, 4.0749e-01, 7.8190e-01,
        7.1650e-01, 1.7680e-01, 7.4785e-02, 9.7994e-01, 5.2611e-01,
        8.4273e-01, 6.0362e-01, 6.6081e-01, 8.7348e-01),
      T(9.7411e-01, 1.6821e-01, 5.6251e-01, 8.7313e-01, 8.6222e-01,
        8.1062e-01, 1.3814e-01, 1.3995e-01, 1.9761e-01, 5.6281e-01,
        9.9833e-01, 1.8416e-01, 7.6644e-01, 2.2326e-01),
      T(2.9892e-02, 3.9373e-01, 7.8809e-01, 9.6419e-01, 1.8948e-01,
        6.0851e-01, 9.3143e-01, 8.3133e-01, 8.1161e-01, 8.5532e-01,
        8.1626e-01, 6.2915e-01, 1.5809e-01, 8.0121e-02),
      T(2.7089e-01, 4.4178e-01, 1.9352e-01, 6.8293e-01, 6.5474e-01,
        3.8678e-01, 6.9217e-01, 6.6159e-01, 8.0527e-01, 8.3672e-01,
        3.3067e-01, 9.8851e-01, 4.4220e-01, 4.8282e-01),
      T(2.8060e-02, 1.7819e-01, 2.0790e-01, 2.8614e-01, 8.5548e-01,
        3.3661e-01, 1.2636e-01, 6.9237e-01, 6.6008e-01, 8.2385e-01,
        2.4126e-01, 6.0841e-01, 3.1797e-01, 3.8766e-01),
      T(1.0154e-01, 2.7212e-01, 3.4687e-01, 7.1382e-01, 5.9134e-01,
        6.2351e-01, 9.9905e-01, 9.8731e-01, 8.4102e-01, 5.1592e-01,
        1.5410e-01, 8.9075e-01, 3.7497e-01, 4.5958e-01),
      T(6.9251e-02, 4.0124e-01, 1.7751e-01, 9.5945e-01, 6.7739e-02,
        1.1026e-01, 4.8302e-01, 2.2964e-01, 6.7891e-01, 3.0754e-01,
        2.6516e-01, 5.2832e-01, 8.6195e-01, 1.4829e-01)),
      T(T(7.3480e-01, 8.2122e-01, 9.8910e-01, 1.5003e-01, 6.2109e-01,
        1.3029e-01, 9.2688e-01, 3.0605e-01, 8.0118e-01, 5.1489e-01,
        4.6106e-01, 4.8405e-01, 5.8500e-01, 7.3570e-01),
        T(5.8019e-01, 6.5253e-01, 5.0238e-02, 8.6427e-01, 9.3593e-01,
          9.1330e-01, 8.6961e-01, 1.3918e-01, 3.1465e-01, 9.4086e-01,
          1.1917e-01, 9.5361e-01, 1.0675e-01, 1.4780e-01),
        T(7.4444e-01, 1.4076e-01, 3.8545e-01, 8.6375e-01, 8.9604e-01,
          9.7288e-01, 3.9854e-01, 1.1137e-01, 9.9231e-01, 3.9349e-01,
          2.9428e-01, 6.2189e-01, 1.5034e-01, 8.2864e-01),
        T(8.1337e-01, 1.0326e-01, 8.9314e-02, 4.5620e-01, 7.1001e-01,
          4.8552e-01, 2.4646e-01, 5.1143e-01, 3.0034e-02, 1.4662e-01,
          1.6716e-01, 9.1177e-01, 9.4075e-01, 3.3017e-01),
        T(5.2243e-01, 7.2299e-01, 5.5991e-01, 2.4962e-01, 7.8837e-01,
          8.0737e-01, 4.7102e-01, 4.3845e-01, 9.5437e-01, 9.3706e-01,
          2.1651e-01, 9.8919e-01, 6.2374e-01, 1.6787e-01),
        T(7.7371e-01, 1.2671e-01, 9.6196e-01, 1.7856e-01, 6.4141e-01,
          6.5225e-01, 6.1893e-01, 9.1471e-01, 2.9233e-01, 2.8891e-01,
          6.6714e-02, 4.7948e-01, 2.6314e-01, 5.2003e-01),
        T(3.9750e-01, 6.6590e-01, 9.3254e-01, 6.4754e-01, 3.3893e-01,
          2.5465e-01, 6.3923e-02, 9.2072e-01, 4.0528e-01, 6.0093e-01,
          5.1850e-01, 1.8137e-01, 7.8159e-01, 7.8021e-01),
        T(5.2518e-01, 2.1586e-01, 2.8755e-01, 5.0689e-01, 2.1433e-01,
          2.2102e-01, 4.2542e-01, 3.5602e-01, 6.2274e-01, 3.6858e-01,
          4.3372e-01, 3.0916e-01, 4.3070e-02, 9.3606e-01),
        T(5.9539e-01, 9.4711e-01, 4.1942e-01, 3.7434e-01, 2.9947e-02,
          3.1019e-01, 8.2789e-01, 1.0277e-02, 3.2512e-01, 8.0463e-01,
          7.8817e-01, 6.8462e-01, 4.0103e-01, 4.6214e-01),
        T(4.0505e-01, 3.1568e-01, 7.0866e-01, 3.2970e-01, 2.1911e-01,
          6.1343e-01, 1.3860e-01, 3.9329e-01, 7.5551e-01, 6.8686e-01,
          9.2567e-01, 1.5898e-01, 5.0435e-01, 3.5235e-01),
        T(2.2034e-01, 2.1872e-01, 6.2597e-01, 5.5231e-01, 2.4478e-01,
          1.4757e-01, 8.5736e-02, 9.9003e-01, 4.1478e-01, 3.8438e-01,
          3.1614e-01, 2.4992e-01, 4.2744e-02, 2.0647e-01),
        T(8.0561e-01, 6.0959e-01, 3.2362e-01, 3.1104e-01, 8.1941e-01,
          8.6042e-01, 9.8172e-01, 6.4585e-01, 7.4156e-01, 4.5983e-01,
          2.0768e-01, 1.0159e-02, 8.0455e-01, 4.2733e-01),
        T(7.0542e-01, 5.2461e-01, 3.3340e-02, 2.5470e-01, 6.4067e-01,
          3.9880e-01, 1.7169e-02, 6.7533e-01, 5.1918e-01, 3.3931e-01,
          7.0199e-01, 6.0556e-01, 3.1560e-01, 9.4917e-01),
        T(7.5084e-01, 5.6278e-01, 4.0397e-01, 7.6480e-02, 8.8604e-01,
          3.7098e-01, 1.7689e-01, 8.2058e-01, 6.7758e-01, 6.2373e-01,
          4.0086e-01, 3.4396e-01, 5.8485e-01, 8.8692e-01)),
      T(T(5.7160e-01, 2.6358e-01, 9.9669e-01, 5.1069e-01, 8.9526e-01,
        6.2186e-01, 9.4818e-01, 7.8849e-01, 2.4509e-01, 8.5123e-01,
        5.0322e-01, 9.8641e-02, 3.9523e-01, 4.8694e-02),
        T(2.4095e-01, 1.4578e-01, 8.4198e-01, 3.9496e-01, 4.1361e-01,
          7.3961e-01, 7.0349e-01, 1.7002e-01, 6.8427e-01, 7.1241e-01,
          1.0245e-01, 9.3472e-01, 1.9576e-01, 3.0447e-01),
        T(8.8157e-02, 9.5699e-01, 5.9521e-01, 9.2102e-01, 5.3265e-01,
          7.7177e-01, 3.4036e-01, 1.0111e-01, 5.8026e-01, 4.5541e-01,
          4.4952e-01, 2.5444e-01, 5.1035e-01, 6.4359e-01),
        T(6.8037e-01, 9.7218e-02, 7.4156e-01, 5.5142e-01, 8.4486e-01,
          8.5336e-01, 1.0624e-01, 9.8016e-01, 8.2746e-03, 7.8743e-01,
          5.3519e-01, 7.3660e-01, 2.2962e-01, 8.0060e-01),
        T(2.5258e-01, 5.8052e-02, 6.6752e-01, 7.7368e-01, 9.9563e-01,
          4.4774e-01, 9.8099e-01, 8.2122e-01, 2.5202e-01, 1.1433e-01,
          7.8043e-01, 2.2606e-01, 7.2935e-01, 7.1782e-02),
        T(8.6478e-01, 6.4986e-01, 4.4252e-01, 7.2931e-01, 1.4403e-01,
          3.9070e-01, 5.0490e-01, 2.1109e-01, 3.7224e-01, 2.8437e-01,
          9.7652e-01, 9.2477e-01, 9.3124e-01, 9.0867e-01),
        T(2.1147e-02, 6.6725e-01, 6.8429e-01, 1.3326e-01, 7.0267e-01,
          2.2869e-01, 5.7951e-01, 6.6561e-01, 9.3145e-01, 2.3769e-01,
          1.0661e-01, 9.6263e-01, 7.0988e-01, 7.4302e-01),
        T(6.7998e-01, 3.2302e-01, 8.0077e-01, 6.3483e-02, 5.6958e-01,
          7.2602e-01, 8.4162e-01, 2.5031e-01, 1.6206e-01, 6.8741e-01,
          1.0292e-01, 8.4468e-02, 5.0341e-02, 2.5753e-01),
        T(4.0456e-01, 2.0390e-01, 2.8859e-01, 5.7257e-02, 8.0732e-01,
          3.8554e-01, 1.8453e-01, 6.3018e-01, 1.2615e-01, 8.5000e-01,
          7.8751e-01, 8.6442e-03, 1.0753e-01, 1.7031e-01),
        T(2.2933e-01, 5.6243e-01, 5.5716e-03, 1.2932e-01, 7.2834e-01,
          3.3624e-01, 3.0104e-01, 8.6359e-02, 7.0266e-01, 5.3531e-01,
          3.0673e-01, 1.9381e-01, 6.0634e-01, 6.3605e-01),
        T(7.2193e-01, 6.4859e-01, 4.2373e-01, 1.1295e-01, 8.1830e-01,
          4.9571e-01, 1.6771e-01, 9.3119e-01, 7.7877e-01, 1.0704e-01,
          2.5029e-01, 3.2985e-01, 2.1136e-01, 7.3349e-01),
        T(1.4330e-01, 9.6468e-01, 2.9333e-01, 7.9514e-01, 5.1703e-01,
          2.8010e-01, 8.3389e-01, 1.1848e-01, 2.3546e-01, 5.5993e-01,
          8.9664e-01, 2.8577e-01, 1.9553e-01, 1.8079e-01),
        T(2.7956e-01, 3.2728e-01, 3.8354e-01, 2.1556e-01, 6.5627e-01,
          5.0406e-01, 1.7332e-01, 2.1447e-01, 6.0588e-01, 4.9286e-01,
          8.5387e-01, 4.2420e-01, 9.4949e-02, 1.3019e-01),
        T(3.5324e-01, 3.8926e-01, 5.5706e-01, 3.8786e-01, 6.8449e-01,
          3.3371e-01, 8.6698e-01, 6.1484e-01, 3.4628e-01, 9.4560e-01,
          6.2765e-01, 1.6021e-01, 2.2173e-01, 8.1351e-01)),
      T(T(7.2836e-01, 8.9040e-01, 4.6159e-01, 8.4971e-01, 7.4859e-01,
        6.5463e-01, 3.8428e-01, 9.8199e-01, 6.0118e-01, 3.7099e-01,
        4.9289e-01, 9.9152e-01, 8.3583e-01, 4.6295e-01),
        T(9.9018e-01, 7.1957e-01, 2.3379e-01, 4.4966e-02, 7.9057e-01,
          9.6892e-01, 2.0869e-01, 7.0536e-01, 5.2129e-01, 3.9309e-01,
          3.6404e-01, 6.3910e-01, 6.1023e-01, 8.3770e-01),
        T(6.8304e-01, 7.2753e-01, 9.4108e-01, 6.5569e-01, 5.7422e-01,
          3.1797e-01, 8.6669e-01, 5.7384e-01, 8.2228e-01, 9.8282e-01,
          3.8817e-01, 8.5205e-01, 3.9846e-01, 9.5121e-01),
        T(8.9355e-01, 3.2078e-01, 5.1793e-01, 2.8165e-01, 2.9778e-01,
          3.9877e-01, 4.9659e-01, 3.2570e-01, 2.8001e-02, 1.9759e-01,
          4.5727e-01, 3.4038e-01, 8.7138e-01, 9.0643e-01),
        T(8.1853e-01, 7.2129e-01, 1.0362e-01, 9.7238e-01, 5.9395e-02,
          3.3562e-01, 1.4809e-01, 6.7980e-01, 8.3942e-02, 2.5350e-01,
          1.8239e-01, 1.9266e-01, 2.6659e-01, 9.9151e-01),
        T(4.5916e-01, 6.5241e-01, 3.6580e-03, 9.4456e-01, 3.9112e-01,
          4.1128e-02, 8.4458e-01, 3.6480e-01, 9.5407e-01, 1.6038e-01,
          3.5784e-02, 1.2437e-01, 7.1659e-01, 4.4393e-01),
        T(3.6790e-02, 5.9271e-01, 4.6813e-01, 6.8063e-01, 2.4566e-01,
          1.4306e-01, 8.4079e-01, 2.5940e-01, 8.5172e-01, 9.0540e-01,
          1.5033e-01, 2.6948e-01, 5.6019e-01, 2.8567e-02),
        T(6.5355e-01, 2.9167e-01, 2.7831e-01, 1.1347e-01, 7.3391e-01,
          1.8138e-01, 1.0035e-01, 3.6851e-01, 2.2165e-01, 1.3901e-02,
          7.0151e-01, 3.0977e-01, 8.5023e-01, 8.5196e-01),
        T(1.8111e-01, 2.0851e-01, 3.2252e-01, 7.9288e-01, 4.8279e-01,
          3.2138e-01, 8.0974e-01, 9.7417e-01, 8.6965e-01, 1.1765e-01,
          3.9615e-01, 4.0409e-01, 9.2670e-01, 2.4140e-01),
        T(2.1343e-01, 5.0782e-01, 3.8385e-01, 6.8926e-01, 5.6078e-01,
          2.0147e-01, 8.6357e-01, 8.1124e-01, 6.0949e-01, 4.7438e-02,
          7.3496e-01, 8.3223e-01, 6.3920e-01, 3.0673e-01),
        T(5.3353e-01, 3.0792e-01, 9.7073e-01, 9.8281e-01, 4.4173e-01,
          1.6360e-01, 7.9413e-01, 7.5519e-01, 7.6504e-01, 1.2377e-01,
          6.6954e-01, 2.8662e-01, 6.0524e-02, 1.5086e-01),
        T(7.1195e-01, 6.8719e-01, 6.1167e-02, 7.8354e-01, 8.8312e-01,
          8.7956e-01, 7.8232e-01, 4.2151e-01, 8.3503e-01, 8.9144e-01,
          7.6064e-01, 1.4037e-01, 3.2550e-01, 8.9611e-01),
        T(8.8119e-01, 8.1904e-01, 2.9102e-01, 4.0098e-01, 1.2750e-01,
          2.1505e-01, 8.8382e-01, 8.9611e-02, 3.7644e-01, 6.0613e-01,
          1.9999e-01, 6.1655e-01, 4.1962e-01, 6.9996e-01),
        T(1.1631e-01, 5.6900e-01, 4.4137e-02, 8.1020e-01, 9.8569e-01,
          3.2154e-01, 5.7394e-01, 2.4239e-01, 1.8016e-01, 2.4677e-01,
          2.6180e-01, 5.9491e-01, 4.4269e-01, 5.3506e-01)),
      T(T(1.1683e-01, 1.8587e-01, 6.7140e-02, 1.4063e-01, 9.1871e-01,
        6.8576e-01, 2.3151e-02, 4.1655e-01, 5.4013e-01, 7.6711e-01,
        9.6373e-01, 6.2074e-01, 8.5222e-01, 3.2208e-01),
        T(4.8366e-01, 1.9817e-01, 6.1519e-01, 9.6153e-01, 8.1399e-01,
          9.9754e-01, 2.7471e-01, 4.3744e-01, 6.0314e-01, 9.0199e-01,
          4.0379e-02, 2.5444e-01, 5.7253e-01, 2.1100e-01),
        T(6.8678e-01, 4.6591e-01, 3.7044e-01, 7.6815e-01, 8.5734e-01,
          9.8634e-01, 7.2642e-01, 4.8633e-01, 9.0880e-01, 8.9792e-01,
          2.4941e-01, 7.2775e-01, 5.5859e-01, 2.8391e-01),
        T(3.8093e-01, 3.8193e-01, 1.5011e-01, 3.4742e-01, 6.6825e-01,
          8.6706e-01, 5.3798e-01, 1.5799e-02, 7.6481e-01, 3.4871e-01,
          9.4653e-01, 1.6860e-02, 3.8302e-01, 8.8776e-01),
        T(7.1630e-01, 2.5055e-01, 6.7046e-02, 4.9463e-01, 6.9316e-01,
          8.4901e-02, 8.1598e-02, 4.9371e-01, 3.9746e-01, 8.2137e-01,
          1.5533e-02, 4.2047e-01, 1.1254e-01, 4.2718e-01),
        T(2.4454e-01, 6.5736e-01, 8.1722e-02, 1.0667e-01, 2.1625e-01,
          6.2081e-02, 8.1563e-01, 4.2844e-01, 2.2221e-01, 8.5036e-01,
          3.8656e-01, 7.5860e-01, 3.4501e-01, 8.1675e-02),
        T(6.0981e-01, 8.1135e-01, 1.2484e-02, 5.5205e-01, 5.9966e-01,
          5.5739e-01, 4.8763e-01, 3.4458e-01, 1.1183e-01, 5.8155e-01,
          1.6419e-01, 8.6876e-02, 3.3947e-01, 1.5772e-01),
        T(6.5325e-01, 8.5615e-01, 8.8858e-01, 1.9009e-01, 7.7260e-01,
          8.5531e-01, 5.0561e-01, 7.1094e-01, 7.8292e-01, 8.8257e-01,
          7.6754e-01, 7.1342e-01, 3.1023e-01, 2.2123e-01),
        T(2.6291e-01, 9.1139e-01, 3.7890e-01, 5.1788e-01, 3.3707e-02,
          4.7779e-01, 3.5895e-01, 1.7738e-01, 8.8723e-01, 9.5194e-02,
          4.2853e-01, 4.6455e-01, 4.7348e-02, 8.0231e-01),
        T(3.4091e-01, 7.2462e-01, 7.7906e-01, 9.4089e-01, 6.2367e-01,
          8.7537e-01, 9.6177e-01, 5.9910e-01, 3.9812e-01, 3.6310e-01,
          5.8100e-01, 6.7994e-01, 2.8309e-02, 8.7463e-01),
        T(5.7885e-01, 3.4235e-02, 6.6015e-01, 8.1731e-01, 6.8683e-01,
          9.0814e-01, 5.1034e-01, 8.5194e-02, 4.9887e-01, 8.6343e-01,
          2.5951e-01, 7.1327e-01, 6.1526e-01, 4.1887e-01),
        T(5.0355e-01, 7.1273e-01, 1.5785e-01, 8.1569e-01, 8.3850e-01,
          7.8057e-01, 9.9964e-01, 4.7817e-01, 1.4693e-01, 5.2283e-01,
          3.5494e-01, 6.7651e-01, 9.2295e-01, 2.2633e-01),
        T(5.2094e-01, 9.8632e-01, 1.0085e-01, 4.1372e-01, 9.8553e-01,
          8.4937e-01, 6.4512e-01, 2.8435e-01, 4.5339e-01, 5.1638e-02,
          2.9266e-02, 3.1533e-02, 9.8024e-01, 8.9547e-01),
        T(6.9834e-01, 3.7441e-01, 9.3050e-01, 3.6793e-01, 8.4711e-01,
          4.8373e-01, 2.6480e-01, 3.6045e-01, 3.9324e-01, 4.2332e-02,
          6.4952e-01, 3.4766e-01, 7.2972e-01, 8.1879e-01)),
      T(T(4.2051e-01, 7.4249e-01, 5.9990e-01, 8.3578e-01, 1.7755e-01,
        4.5610e-01, 3.3339e-01, 9.3812e-01, 5.1204e-02, 2.1896e-01,
        5.5645e-01, 9.4387e-01, 8.3831e-01, 3.2121e-02),
        T(1.4847e-01, 9.8480e-01, 5.7287e-01, 7.1747e-02, 3.4247e-01,
          7.1859e-01, 3.9545e-01, 1.1594e-01, 1.9129e-01, 2.4098e-01,
          4.8042e-01, 6.9595e-01, 7.4006e-01, 2.5710e-01),
        T(4.1611e-01, 1.1396e-01, 8.7812e-01, 9.9898e-01, 9.8599e-01,
          7.0434e-01, 3.9338e-01, 4.8754e-01, 6.8039e-01, 6.6595e-02,
          5.3104e-01, 9.3573e-02, 8.6367e-05, 4.8329e-01),
        T(3.4082e-01, 1.8327e-01, 5.8289e-01, 5.2037e-01, 5.7630e-01,
          2.2016e-01, 1.0256e-02, 5.1094e-01, 2.9602e-01, 3.3143e-01,
          8.6809e-01, 5.8166e-01, 7.2836e-01, 3.6026e-01),
        T(1.0326e-01, 5.9970e-01, 1.6888e-01, 5.6195e-01, 1.0979e-01,
          8.7695e-01, 1.5939e-01, 9.3408e-01, 8.5320e-01, 8.7797e-01,
          8.0002e-01, 6.1573e-01, 4.7563e-01, 4.9202e-01),
        T(3.0114e-01, 4.0402e-02, 9.5574e-01, 5.2591e-01, 7.3516e-01,
          5.1835e-01, 6.4369e-01, 1.9193e-01, 1.1132e-01, 8.8132e-01,
          6.8961e-01, 7.4688e-01, 3.7221e-03, 5.3380e-01),
        T(3.3623e-02, 4.4278e-01, 4.7357e-01, 1.4824e-01, 4.8874e-03,
          5.0329e-01, 9.4965e-01, 9.5061e-01, 1.9559e-01, 4.1118e-01,
          8.1878e-02, 1.0952e-01, 3.6291e-01, 9.8543e-01),
        T(3.6956e-01, 5.2893e-01, 9.7038e-01, 5.8910e-01, 9.0335e-01,
          8.3225e-01, 9.6886e-01, 5.8575e-01, 9.5659e-02, 6.9868e-02,
          2.4166e-01, 9.1269e-01, 7.8752e-01, 6.4634e-01),
        T(1.1924e-01, 1.3175e-01, 9.0792e-01, 4.4810e-01, 2.1646e-03,
          4.3819e-01, 3.7996e-01, 5.0754e-01, 7.0925e-01, 6.9239e-01,
          1.1741e-01, 4.9452e-01, 2.5221e-01, 8.3821e-01),
        T(7.4759e-01, 7.7444e-01, 9.5457e-01, 7.4560e-01, 3.5405e-04,
          6.2616e-01, 1.5691e-01, 5.6677e-01, 5.0534e-01, 9.9591e-01,
          1.5839e-01, 1.0119e-02, 3.6596e-01, 5.8057e-01),
        T(8.6627e-01, 9.0540e-01, 8.8507e-01, 6.5784e-01, 3.5711e-01,
          3.9428e-01, 2.2656e-01, 5.9778e-01, 1.5228e-01, 6.7190e-01,
          8.2291e-01, 9.2428e-01, 7.1689e-03, 9.1023e-01),
        T(1.8590e-01, 4.5918e-01, 9.5644e-01, 7.7095e-01, 3.4140e-01,
          7.9516e-01, 1.3682e-02, 8.9089e-01, 9.8536e-01, 4.7729e-01,
          5.8229e-01, 3.8268e-01, 1.8347e-01, 2.7384e-01),
        T(4.6680e-01, 9.0943e-02, 9.5893e-02, 5.5487e-01, 1.7466e-01,
          2.2803e-01, 4.9568e-01, 2.3650e-01, 9.6282e-01, 3.1950e-01,
          2.2198e-01, 3.6680e-01, 9.2063e-02, 7.5758e-01),
        T(9.2960e-01, 2.1164e-01, 3.1413e-01, 9.6663e-01, 1.3830e-01,
          6.3542e-01, 9.2617e-02, 5.4977e-02, 5.0076e-01, 2.1463e-01,
          7.7079e-01, 3.4535e-01, 5.0493e-01, 2.3896e-01))),
      T(T(T(7.0547e-01, 9.6326e-01, 4.2484e-01, 1.9139e-01, 1.2338e-02,
        9.7913e-01, 7.1074e-01, 7.0649e-01, 5.8513e-01, 7.5089e-01,
        6.7756e-01, 7.4414e-01, 8.1271e-01, 5.7090e-01),
        T(9.3067e-01, 8.1091e-01, 4.8469e-01, 2.7668e-01, 5.3315e-01,
          8.8941e-01, 8.1674e-01, 2.9739e-01, 3.9561e-01, 6.9852e-01,
          6.8839e-01, 9.7612e-01, 7.4279e-01, 6.5929e-01),
        T(6.1556e-01, 3.0101e-02, 3.1579e-01, 5.5292e-01, 1.5217e-01,
          6.1916e-02, 8.3739e-01, 6.7005e-01, 9.6517e-02, 5.2968e-01,
          7.9446e-01, 7.8804e-01, 9.5660e-01, 3.0230e-01),
        T(7.2264e-01, 9.4409e-02, 4.3833e-01, 1.8200e-01, 4.0479e-01,
          7.8464e-01, 7.4926e-01, 2.3699e-01, 3.7602e-01, 3.9997e-01,
          3.0979e-01, 2.2610e-01, 8.6715e-01, 8.4561e-01),
        T(9.1741e-01, 2.2544e-01, 8.6614e-01, 3.4838e-01, 3.8253e-01,
          3.6538e-01, 4.7569e-01, 2.8105e-01, 5.6838e-01, 1.7773e-01,
          7.0564e-01, 8.0689e-02, 3.1874e-01, 1.5077e-01),
        T(8.3728e-01, 8.4352e-01, 1.0232e-01, 2.2716e-01, 9.4749e-01,
          6.4570e-01, 8.4429e-01, 1.1667e-01, 7.2566e-01, 8.1827e-01,
          3.8399e-01, 4.7696e-01, 8.6459e-01, 6.3634e-01),
        T(6.4347e-01, 5.0152e-01, 2.9126e-01, 1.9396e-01, 9.9896e-01,
          4.6050e-01, 9.4371e-01, 9.0910e-01, 2.3854e-01, 5.3399e-01,
          3.7211e-01, 4.9092e-01, 8.2953e-01, 7.7533e-01),
        T(2.1601e-01, 2.5259e-01, 1.4480e-01, 7.5481e-02, 8.2075e-01,
          1.9104e-01, 5.0653e-01, 4.9932e-01, 5.8554e-01, 4.7075e-01,
          7.5947e-01, 5.6867e-01, 8.5854e-01, 6.0793e-01),
        T(4.9376e-01, 5.7085e-01, 8.3325e-01, 5.7547e-01, 8.5224e-01,
          4.5259e-01, 5.0434e-01, 9.2007e-01, 2.7955e-02, 5.4988e-01,
          9.5668e-01, 2.4909e-01, 4.0777e-01, 4.6988e-01),
        T(6.6472e-01, 6.8898e-01, 6.1327e-01, 6.9724e-01, 2.8547e-01,
          7.1035e-01, 3.4146e-01, 8.1417e-01, 3.5326e-01, 7.4246e-02,
          5.3571e-01, 7.6017e-01, 4.8040e-01, 5.0649e-01),
        T(5.0177e-01, 7.6537e-01, 5.3912e-01, 5.3330e-02, 1.4342e-01,
          5.2956e-01, 4.5985e-01, 9.7793e-01, 3.8246e-01, 8.8265e-01,
          7.8317e-02, 2.4793e-02, 4.5401e-01, 1.8341e-01),
        T(3.5419e-01, 5.5632e-01, 6.6289e-02, 8.4359e-01, 1.9655e-01,
          8.8364e-01, 6.6344e-01, 4.0623e-01, 6.2425e-02, 5.8276e-01,
          2.2067e-01, 9.3213e-01, 7.9374e-02, 3.6792e-01),
        T(2.2444e-01, 1.7842e-01, 2.3922e-01, 4.5043e-01, 5.3382e-01,
          5.8470e-01, 7.5550e-01, 2.9577e-01, 1.8977e-01, 3.9465e-01,
          9.7118e-01, 4.3891e-01, 7.9069e-02, 8.9233e-01),
        T(6.2166e-01, 5.8678e-01, 5.8582e-01, 8.4885e-01, 2.7233e-01,
          8.6441e-01, 9.8080e-01, 3.7107e-01, 8.1557e-01, 7.7586e-01,
          9.6824e-01, 3.8363e-01, 2.0257e-01, 3.1440e-01)),
        T(T(1.5983e-01, 5.1715e-01, 9.8207e-01, 9.8507e-01, 8.7768e-01,
          5.4948e-01, 5.1085e-01, 8.3106e-01, 7.9689e-01, 4.5038e-01,
          3.7354e-01, 6.9771e-01, 4.8265e-01, 1.4873e-01),
          T(2.6482e-01, 9.0549e-01, 9.1640e-01, 3.0517e-01, 3.9270e-01,
            2.5219e-01, 3.3676e-01, 9.5578e-01, 5.5298e-02, 7.3859e-01,
            5.0606e-02, 2.6145e-01, 3.9818e-01, 5.3465e-01),
          T(4.1880e-01, 2.7144e-01, 2.7698e-01, 1.9588e-01, 1.5100e-01,
            1.8849e-01, 9.7946e-01, 2.6441e-01, 8.4206e-02, 8.4365e-01,
            6.9398e-01, 8.4393e-01, 2.6526e-03, 2.4059e-02),
          T(1.4513e-01, 2.3660e-01, 4.9890e-01, 7.1628e-01, 7.9273e-01,
            6.9948e-02, 6.9941e-01, 2.1085e-01, 6.1493e-01, 6.5698e-01,
            5.8002e-01, 6.7690e-01, 4.7503e-01, 8.3009e-01),
          T(6.0428e-01, 9.3805e-01, 6.0838e-01, 2.3531e-01, 8.2110e-01,
            5.2709e-01, 9.8322e-01, 4.4470e-01, 9.9471e-01, 2.0812e-01,
            7.5129e-01, 1.2700e-01, 8.4327e-01, 5.9076e-01),
          T(7.8387e-01, 6.9411e-02, 2.6239e-03, 7.4092e-01, 2.9429e-01,
            6.9802e-01, 2.0336e-01, 3.4543e-01, 5.0224e-01, 8.0110e-01,
            7.8236e-01, 4.5534e-01, 3.5857e-01, 4.9133e-01),
          T(7.5770e-01, 7.6215e-02, 3.4722e-01, 1.8002e-02, 5.7217e-01,
            4.4086e-01, 7.8325e-01, 8.9944e-01, 7.2483e-02, 2.7872e-01,
            4.1962e-01, 4.9501e-01, 3.8587e-01, 1.8563e-01),
          T(3.0680e-01, 4.8712e-01, 9.0209e-01, 3.7257e-01, 8.3020e-01,
            9.5825e-02, 5.2236e-01, 1.0981e-01, 3.0817e-02, 5.4955e-01,
            2.7106e-01, 8.6811e-01, 8.9493e-01, 2.3382e-03),
          T(4.6515e-01, 4.1458e-01, 2.1501e-01, 1.5093e-01, 2.8841e-01,
            7.2075e-01, 6.1888e-01, 8.0093e-01, 4.7018e-01, 7.5969e-01,
            5.9669e-01, 3.9097e-01, 4.7077e-01, 4.5253e-02),
          T(4.8852e-01, 3.3574e-01, 3.3267e-01, 2.9918e-01, 3.9068e-01,
            1.3086e-01, 5.2934e-01, 4.7968e-01, 3.6831e-01, 9.3404e-01,
            8.3556e-01, 6.4121e-01, 3.1584e-01, 5.6377e-01),
          T(1.5597e-01, 8.4839e-01, 9.6701e-01, 4.2535e-01, 8.8560e-01,
            9.6925e-01, 4.6996e-01, 3.1434e-01, 5.2523e-01, 5.8263e-01,
            3.7164e-02, 4.6881e-01, 3.1922e-01, 8.3365e-01),
          T(4.8565e-01, 8.2897e-01, 9.4474e-01, 3.4330e-01, 6.0763e-01,
            4.5723e-01, 2.8210e-01, 2.2263e-01, 5.1157e-01, 6.5191e-01,
            4.1206e-01, 5.8491e-01, 8.1246e-01, 7.0844e-01),
          T(7.0619e-01, 6.4052e-01, 1.1564e-01, 1.9750e-01, 1.2921e-01,
            8.2857e-01, 5.9616e-02, 1.2671e-01, 8.2928e-01, 7.9555e-01,
            2.7341e-02, 7.8891e-01, 3.8591e-01, 6.0772e-01),
          T(1.8678e-01, 4.2410e-01, 6.1113e-01, 8.8124e-01, 8.0320e-01,
            2.2811e-01, 1.7203e-01, 4.6957e-01, 6.5692e-01, 7.7415e-01,
            1.7485e-03, 4.5914e-01, 5.1768e-01, 2.6649e-01)),
        T(T(8.9437e-01, 3.6728e-01, 2.3301e-02, 2.0146e-01, 5.1603e-01,
          1.2792e-01, 6.1421e-01, 9.8640e-01, 5.2047e-01, 3.7682e-01,
          9.7105e-01, 8.6912e-01, 8.3226e-01, 5.3793e-01),
          T(5.2286e-01, 1.1224e-01, 5.5090e-01, 9.8633e-01, 5.2643e-01,
            5.3807e-02, 7.7443e-01, 9.4873e-01, 9.1917e-01, 5.2358e-01,
            5.9393e-01, 5.8092e-01, 2.9507e-01, 4.2704e-01),
          T(9.0790e-01, 5.5101e-01, 9.7124e-01, 1.6797e-01, 4.2693e-01,
            5.0586e-01, 2.0242e-01, 8.8604e-01, 8.4921e-01, 2.3030e-01,
            9.4049e-01, 9.6624e-01, 2.0601e-01, 4.8275e-01),
          T(9.9829e-01, 1.7540e-01, 4.2167e-01, 1.5687e-01, 8.6078e-01,
            5.8105e-01, 7.0815e-01, 8.5879e-01, 4.2067e-01, 2.0623e-04,
            5.2448e-01, 4.6131e-01, 6.8133e-01, 7.3340e-01),
          T(2.5136e-01, 3.0305e-01, 8.1520e-01, 6.4234e-01, 6.1454e-01,
            7.2262e-01, 7.3250e-01, 1.3872e-01, 5.3993e-01, 5.4780e-01,
            1.7017e-02, 6.0611e-01, 4.9333e-01, 8.8783e-01),
          T(2.2752e-02, 9.7033e-01, 2.5531e-01, 7.9456e-01, 8.6939e-01,
            4.3796e-01, 2.4419e-01, 4.1699e-01, 1.8817e-01, 5.6180e-01,
            7.1017e-01, 6.0333e-01, 2.1206e-01, 7.7320e-01),
          T(9.5882e-01, 3.4787e-01, 7.5963e-01, 4.6704e-01, 7.0154e-01,
            1.4341e-01, 7.3050e-02, 4.8581e-01, 7.8705e-02, 6.8011e-01,
            9.6807e-01, 4.0194e-01, 5.0482e-01, 5.7604e-01),
          T(2.5838e-01, 4.7442e-01, 6.2881e-01, 9.0435e-01, 8.5177e-02,
            4.9010e-01, 9.2080e-02, 4.5573e-01, 4.8681e-01, 2.9151e-01,
            8.0668e-01, 8.4305e-01, 3.0603e-01, 4.3029e-01),
          T(3.4676e-01, 5.1347e-01, 6.6480e-01, 9.6227e-01, 4.1383e-02,
            7.0307e-01, 1.9890e-01, 9.1689e-02, 8.8505e-01, 3.5104e-01,
            2.1963e-01, 6.3716e-01, 3.9596e-01, 4.2340e-02),
          T(2.3920e-01, 2.8877e-01, 4.6100e-01, 1.6992e-01, 1.8454e-02,
            7.7809e-01, 7.0644e-02, 4.3947e-01, 9.2918e-01, 3.1597e-01,
            1.6935e-01, 6.3352e-01, 9.3633e-01, 4.4486e-01),
          T(4.7050e-01, 7.3362e-01, 5.6263e-01, 5.9578e-01, 7.6459e-01,
            7.2726e-01, 1.4192e-01, 3.0261e-01, 8.4157e-01, 5.7716e-01,
            6.1647e-01, 9.8025e-01, 8.0950e-01, 6.9952e-01),
          T(9.7845e-01, 6.0182e-02, 5.7759e-01, 6.3055e-01, 4.1306e-01,
            2.6520e-01, 5.9229e-01, 8.6702e-02, 2.8699e-01, 8.7974e-01,
            3.1630e-01, 3.5605e-01, 7.2427e-01, 3.7350e-01),
          T(5.7344e-01, 2.7394e-04, 7.8471e-01, 5.5189e-02, 5.6660e-01,
            3.9345e-03, 7.0859e-02, 9.0224e-01, 2.2468e-01, 4.8274e-01,
            5.2227e-01, 9.6007e-01, 6.5963e-01, 7.4407e-01),
          T(2.8610e-01, 3.2856e-01, 8.6371e-01, 6.8330e-01, 6.2539e-01,
            1.2294e-01, 1.0095e-01, 6.0095e-01, 1.2478e-01, 8.5056e-01,
            9.1663e-01, 2.9292e-01, 1.7773e-01, 9.8402e-01)),
        T(T(2.3324e-01, 1.0149e-01, 1.3710e-01, 5.8686e-01, 5.9710e-01,
          8.2286e-01, 9.0264e-01, 7.1324e-01, 5.7138e-01, 9.5159e-01,
          2.9366e-01, 4.1232e-01, 9.2340e-01, 3.3171e-01),
          T(7.6807e-01, 6.0723e-01, 6.7649e-01, 3.8568e-01, 7.4144e-02,
            8.5855e-01, 9.1167e-01, 1.0295e-01, 2.6599e-01, 5.2120e-01,
            7.4774e-01, 4.2923e-01, 2.8079e-01, 8.8909e-01),
          T(2.4899e-01, 9.5431e-01, 5.0850e-01, 7.6249e-01, 6.1756e-01,
            5.8801e-01, 8.6793e-01, 4.7494e-01, 8.5278e-01, 6.6506e-01,
            2.2092e-01, 8.2772e-01, 1.4477e-01, 7.6033e-01),
          T(3.9288e-01, 6.5515e-01, 4.4017e-01, 5.9883e-01, 3.4898e-01,
            7.0722e-01, 7.3339e-01, 4.2661e-02, 9.4084e-01, 9.6790e-02,
            2.7683e-01, 6.9684e-01, 9.6085e-01, 6.6258e-01),
          T(2.2099e-01, 5.8799e-01, 1.9994e-01, 7.3523e-01, 5.2556e-01,
            5.4876e-01, 1.1646e-01, 7.6685e-01, 9.7505e-01, 1.5313e-01,
            6.7008e-01, 2.7951e-01, 3.6598e-01, 9.4265e-01),
          T(3.2000e-02, 4.0558e-01, 6.7983e-01, 7.2709e-01, 3.0457e-01,
            2.2704e-01, 6.0081e-01, 4.4824e-02, 5.6638e-01, 1.8376e-01,
            4.0864e-01, 9.5007e-01, 8.4802e-02, 2.5270e-01),
          T(1.1533e-01, 7.9802e-01, 9.1298e-01, 1.7666e-01, 8.1548e-01,
            8.2028e-01, 7.0404e-02, 6.7061e-01, 7.2725e-01, 4.1077e-01,
            8.3636e-01, 4.6896e-01, 4.3508e-01, 7.8051e-01),
          T(4.2850e-02, 8.9116e-03, 5.9289e-01, 5.5510e-01, 5.3541e-01,
            1.9365e-01, 8.9844e-01, 1.9082e-01, 2.7886e-01, 7.7993e-02,
            2.0260e-03, 6.2096e-01, 2.9851e-01, 8.0604e-01),
          T(9.8269e-01, 6.6240e-01, 9.3715e-01, 1.5198e-01, 7.6339e-01,
            7.7177e-01, 2.9987e-01, 4.6451e-01, 1.9996e-01, 5.4816e-01,
            2.2336e-02, 2.0146e-01, 6.8990e-02, 4.3690e-01),
          T(5.5096e-01, 9.8001e-02, 3.1629e-01, 8.0023e-01, 5.2422e-01,
            5.8760e-01, 2.7919e-01, 3.5294e-01, 5.6719e-02, 9.6577e-01,
            5.5686e-01, 7.3030e-01, 7.9230e-01, 9.3839e-01),
          T(1.5511e-01, 6.3955e-01, 6.6621e-02, 6.8612e-01, 2.4343e-01,
            6.9470e-01, 1.3187e-01, 7.6457e-01, 8.5805e-01, 7.7485e-01,
            8.0154e-02, 8.1268e-01, 1.8274e-01, 3.2347e-02),
          T(8.2547e-01, 5.8515e-01, 3.2588e-01, 6.2962e-02, 6.2855e-01,
            2.8387e-01, 1.0353e-01, 4.3725e-01, 7.4198e-02, 7.4632e-01,
            1.7055e-01, 3.2981e-01, 5.3604e-03, 4.3045e-01),
          T(3.4561e-01, 7.7590e-01, 3.8686e-01, 8.3659e-01, 9.3653e-01,
            6.0199e-01, 3.2863e-01, 8.8079e-02, 1.5017e-01, 3.3156e-01,
            1.8665e-01, 7.6474e-01, 3.3857e-01, 4.8170e-01),
          T(5.2081e-01, 6.7961e-02, 9.1693e-01, 3.0890e-01, 9.5284e-02,
            4.9209e-01, 6.0516e-02, 5.6239e-01, 1.7645e-01, 3.9035e-01,
            3.5294e-01, 8.6183e-01, 8.8587e-01, 9.9566e-01)),
        T(T(5.5508e-01, 8.1893e-01, 8.9672e-02, 1.6460e-01, 7.6909e-01,
          6.0983e-01, 6.3839e-01, 7.8582e-01, 8.1703e-01, 7.3497e-01,
          3.1478e-01, 3.4161e-01, 6.0530e-01, 9.1151e-01),
          T(4.6211e-01, 3.5117e-01, 7.7624e-01, 8.3147e-01, 4.9072e-01,
            3.5214e-01, 1.8699e-03, 5.3072e-01, 6.5327e-01, 1.3292e-01,
            1.2878e-01, 1.2875e-04, 8.9068e-01, 9.6873e-01),
          T(9.9483e-01, 9.4638e-01, 4.4729e-01, 7.2239e-01, 7.9595e-01,
            3.6644e-01, 2.1193e-01, 9.1620e-01, 4.4760e-01, 6.8437e-01,
            2.6618e-01, 2.4207e-01, 4.0735e-01, 5.1654e-01),
          T(7.9580e-01, 8.2481e-01, 4.3718e-01, 9.9157e-01, 2.3382e-01,
            5.3361e-01, 1.8663e-01, 5.8185e-01, 9.5571e-01, 8.6407e-02,
            6.1762e-01, 4.0485e-02, 3.8817e-01, 2.6501e-01),
          T(5.0084e-01, 1.5301e-01, 6.2698e-01, 2.8208e-02, 6.0961e-01,
            3.0719e-01, 2.0078e-01, 9.2388e-01, 5.5398e-01, 1.6903e-01,
            2.1818e-01, 2.7691e-01, 2.0414e-01, 5.6183e-01),
          T(5.0704e-01, 9.3590e-01, 5.1460e-01, 2.3329e-01, 9.2993e-01,
            6.2574e-01, 3.9211e-01, 8.5090e-01, 9.0990e-01, 7.9070e-02,
            8.7622e-02, 1.7110e-01, 7.0020e-02, 3.4999e-01),
          T(6.8303e-01, 4.3893e-02, 1.1319e-02, 6.9458e-02, 2.3912e-01,
            8.1349e-01, 9.4330e-01, 9.9671e-01, 5.0545e-01, 7.6525e-02,
            9.8760e-01, 1.6390e-01, 6.8878e-01, 7.4993e-01),
          T(6.5458e-01, 6.6502e-01, 3.3570e-02, 3.3152e-01, 1.7840e-01,
            8.4532e-01, 2.1592e-01, 4.8804e-01, 9.4442e-01, 8.7898e-01,
            1.4026e-01, 8.2895e-02, 8.9574e-01, 6.4390e-01),
          T(1.1666e-01, 9.3233e-01, 1.3904e-01, 9.3284e-01, 8.5871e-01,
            8.5630e-01, 4.0407e-01, 5.4346e-01, 8.2481e-02, 7.8167e-01,
            5.2883e-01, 8.7025e-01, 2.8923e-01, 9.8300e-01),
          T(8.3329e-01, 3.5994e-01, 6.3651e-01, 1.3524e-01, 1.6710e-01,
            1.5741e-01, 2.1277e-01, 6.3901e-01, 2.8450e-01, 3.2731e-01,
            8.4978e-01, 5.8258e-01, 2.5631e-01, 3.6431e-01),
          T(3.6855e-01, 7.3343e-01, 8.5196e-01, 8.9842e-01, 1.5982e-01,
            4.4658e-01, 6.1737e-01, 3.0459e-01, 8.2876e-01, 4.4441e-01,
            5.5335e-01, 7.2536e-02, 8.6128e-01, 1.6869e-01),
          T(4.8798e-01, 9.2176e-02, 8.8039e-01, 5.2890e-01, 7.2517e-01,
            1.0700e-01, 5.4251e-01, 7.0485e-01, 8.5310e-01, 8.6746e-01,
            4.1073e-01, 4.4922e-01, 6.6613e-01, 3.2022e-01),
          T(2.9654e-01, 3.9664e-02, 9.6787e-03, 2.3672e-01, 5.6243e-01,
            5.4030e-01, 5.4011e-01, 5.7488e-01, 4.0766e-01, 6.0146e-03,
            9.4648e-01, 1.3415e-01, 4.9414e-01, 6.9866e-01),
          T(6.2818e-01, 2.8283e-01, 6.5493e-02, 9.0034e-01, 5.1425e-01,
            9.5600e-01, 7.3328e-01, 7.1360e-01, 6.0819e-01, 3.8723e-01,
            2.0696e-01, 5.6072e-01, 9.8047e-01, 7.9975e-01)),
        T(T(9.5425e-01, 9.6891e-01, 8.9068e-01, 2.1936e-01, 2.2770e-01,
          4.8285e-01, 2.4141e-01, 3.6433e-01, 3.2872e-01, 9.3752e-01,
          4.6638e-01, 9.8399e-01, 1.1230e-01, 6.7931e-03),
          T(5.7149e-01, 5.9964e-01, 2.9824e-01, 2.4697e-01, 6.4241e-01,
            5.2505e-01, 4.3301e-01, 7.5383e-01, 2.8736e-01, 8.9330e-01,
            1.5901e-01, 2.3981e-01, 6.7317e-01, 8.0728e-01),
          T(4.9388e-01, 1.0750e-01, 4.8003e-01, 3.3120e-01, 3.4023e-01,
            4.0758e-01, 6.2030e-01, 3.8361e-01, 1.4937e-01, 2.5035e-01,
            8.1198e-02, 5.7542e-04, 7.4163e-01, 7.7937e-01),
          T(8.7784e-01, 5.3958e-01, 2.9434e-01, 1.9928e-01, 7.4903e-01,
            1.9783e-01, 8.7366e-01, 2.2882e-01, 3.3563e-02, 1.3992e-01,
            9.0723e-01, 8.7740e-01, 6.2204e-01, 5.1157e-01),
          T(9.2871e-01, 8.0173e-01, 7.9605e-01, 1.5969e-01, 5.8001e-01,
            9.5301e-01, 1.4778e-01, 9.9813e-01, 1.7251e-01, 3.5308e-01,
            4.7642e-01, 6.3006e-01, 6.5366e-01, 2.1403e-01),
          T(7.2885e-01, 6.3233e-01, 4.4434e-01, 2.3617e-03, 9.9485e-01,
            3.1509e-01, 2.3349e-01, 9.9511e-01, 2.4662e-01, 8.3403e-01,
            8.0510e-01, 1.7456e-01, 9.6771e-02, 2.2818e-01),
          T(6.5649e-01, 9.7165e-01, 4.7224e-01, 3.5066e-01, 3.5616e-01,
            1.5178e-01, 9.9967e-01, 4.9458e-01, 1.0433e-01, 1.5842e-01,
            8.1106e-01, 7.4184e-01, 8.2257e-01, 4.4729e-01),
          T(4.0121e-01, 6.6382e-01, 4.9510e-01, 3.3903e-01, 6.1924e-01,
            2.1504e-01, 1.5380e-01, 3.8947e-01, 1.4357e-01, 5.1269e-01,
            5.7869e-01, 9.8958e-01, 6.4410e-01, 4.9707e-01),
          T(1.3661e-01, 2.9903e-01, 4.1849e-01, 1.3998e-01, 5.9733e-01,
            8.5986e-01, 7.8609e-01, 2.9263e-01, 3.7777e-01, 9.9846e-01,
            4.1994e-01, 5.0943e-02, 4.9561e-01, 5.2542e-01),
          T(3.1425e-01, 4.4573e-01, 9.2277e-02, 6.5397e-01, 1.5300e-01,
            6.7209e-01, 8.7674e-01, 1.7720e-01, 3.0423e-01, 5.4809e-01,
            5.0121e-01, 7.9316e-01, 4.7002e-01, 5.8083e-01),
          T(3.6179e-01, 6.6491e-01, 6.5107e-01, 9.7422e-02, 7.6543e-01,
            3.9753e-01, 9.4773e-01, 3.8145e-03, 4.5036e-01, 7.2593e-01,
            8.4479e-01, 5.0650e-01, 2.2980e-01, 1.1350e-01),
          T(1.2137e-01, 9.0258e-01, 6.4551e-02, 3.0215e-01, 7.6209e-01,
            7.7343e-01, 6.2630e-02, 5.9913e-01, 5.6045e-01, 9.5890e-01,
            4.8227e-01, 7.1233e-01, 4.5679e-01, 9.4629e-01),
          T(4.4896e-01, 2.0619e-01, 5.9222e-01, 2.3534e-01, 6.2503e-01,
            8.4756e-01, 1.1110e-01, 1.3623e-01, 5.0682e-01, 4.7075e-01,
            3.4439e-01, 9.1852e-01, 7.2415e-01, 3.3422e-01),
          T(5.7246e-01, 4.2477e-01, 1.7988e-01, 7.0457e-01, 1.7013e-01,
            5.6051e-01, 8.3942e-01, 4.0780e-02, 5.2192e-01, 9.6175e-01,
            7.2581e-01, 3.0282e-01, 5.7869e-01, 3.0527e-02)))))

    val expectedOutput = Tensor[Float](T(T(T(
      T(0.0025, 0.0044, 0.0056, 0.0062, 0.0064, 0.0062, 0.0059, 0.0056,
      0.0054, 0.0055, 0.0055, 0.0052, 0.0043, 0.0025),
      T(0.0042, 0.0076, 0.0097, 0.0107, 0.0110, 0.0107, 0.0101, 0.0096,
        0.0094, 0.0094, 0.0095, 0.0090, 0.0074, 0.0043),
      T(0.0051, 0.0091, 0.0116, 0.0129, 0.0132, 0.0128, 0.0122, 0.0116,
        0.0114, 0.0114, 0.0114, 0.0109, 0.0090, 0.0052),
      T(0.0053, 0.0094, 0.0119, 0.0132, 0.0135, 0.0133, 0.0127, 0.0122,
        0.0119, 0.0119, 0.0119, 0.0114, 0.0094, 0.0055),
      T(0.0052, 0.0093, 0.0117, 0.0127, 0.0131, 0.0130, 0.0127, 0.0124,
        0.0121, 0.0119, 0.0118, 0.0112, 0.0093, 0.0054),
      T(0.0052, 0.0091, 0.0114, 0.0123, 0.0126, 0.0127, 0.0126, 0.0124,
        0.0121, 0.0118, 0.0116, 0.0110, 0.0091, 0.0053),
      T(0.0052, 0.0091, 0.0113, 0.0122, 0.0124, 0.0125, 0.0125, 0.0124,
        0.0122, 0.0119, 0.0116, 0.0108, 0.0089, 0.0052),
      T(0.0053, 0.0092, 0.0115, 0.0123, 0.0125, 0.0125, 0.0126, 0.0126,
        0.0124, 0.0122, 0.0117, 0.0109, 0.0088, 0.0051),
      T(0.0053, 0.0094, 0.0117, 0.0125, 0.0127, 0.0127, 0.0127, 0.0128,
        0.0128, 0.0125, 0.0120, 0.0109, 0.0087, 0.0050),
      T(0.0054, 0.0095, 0.0118, 0.0128, 0.0130, 0.0130, 0.0130, 0.0131,
        0.0131, 0.0128, 0.0122, 0.0109, 0.0086, 0.0049),
      T(0.0052, 0.0093, 0.0117, 0.0127, 0.0130, 0.0130, 0.0131, 0.0131,
        0.0131, 0.0127, 0.0120, 0.0107, 0.0085, 0.0048),
      T(0.0048, 0.0086, 0.0108, 0.0118, 0.0122, 0.0123, 0.0123, 0.0123,
        0.0121, 0.0117, 0.0111, 0.0100, 0.0080, 0.0045),
      T(0.0038, 0.0068, 0.0086, 0.0095, 0.0098, 0.0099, 0.0099, 0.0098,
        0.0096, 0.0093, 0.0089, 0.0081, 0.0065, 0.0037),
      T(0.0022, 0.0038, 0.0048, 0.0053, 0.0056, 0.0056, 0.0056, 0.0055,
        0.0054, 0.0053, 0.0050, 0.0047, 0.0038, 0.0022)),
      T(T(0.0025, 0.0044, 0.0056, 0.0062, 0.0064, 0.0062, 0.0059, 0.0056,
        0.0054, 0.0055, 0.0055, 0.0052, 0.0043, 0.0025),
        T(0.0042, 0.0076, 0.0097, 0.0107, 0.0110, 0.0107, 0.0101, 0.0096,
          0.0094, 0.0094, 0.0095, 0.0090, 0.0074, 0.0043),
        T(0.0051, 0.0091, 0.0116, 0.0129, 0.0132, 0.0128, 0.0122, 0.0116,
          0.0114, 0.0114, 0.0114, 0.0109, 0.0090, 0.0052),
        T(0.0053, 0.0094, 0.0119, 0.0132, 0.0135, 0.0133, 0.0127, 0.0122,
          0.0119, 0.0119, 0.0119, 0.0114, 0.0094, 0.0055),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0131, 0.0130, 0.0127, 0.0124,
          0.0121, 0.0119, 0.0118, 0.0112, 0.0093, 0.0054),
        T(0.0052, 0.0091, 0.0114, 0.0123, 0.0126, 0.0127, 0.0126, 0.0124,
          0.0121, 0.0118, 0.0116, 0.0110, 0.0091, 0.0053),
        T(0.0052, 0.0091, 0.0113, 0.0122, 0.0124, 0.0125, 0.0125, 0.0124,
          0.0122, 0.0119, 0.0116, 0.0108, 0.0089, 0.0052),
        T(0.0053, 0.0092, 0.0115, 0.0123, 0.0125, 0.0125, 0.0126, 0.0126,
          0.0124, 0.0122, 0.0117, 0.0109, 0.0088, 0.0051),
        T(0.0053, 0.0094, 0.0117, 0.0125, 0.0127, 0.0127, 0.0127, 0.0128,
          0.0128, 0.0125, 0.0120, 0.0109, 0.0087, 0.0050),
        T(0.0054, 0.0095, 0.0118, 0.0128, 0.0130, 0.0130, 0.0130, 0.0131,
          0.0131, 0.0128, 0.0122, 0.0109, 0.0086, 0.0049),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0130, 0.0130, 0.0131, 0.0131,
          0.0131, 0.0127, 0.0120, 0.0107, 0.0085, 0.0048),
        T(0.0048, 0.0086, 0.0108, 0.0118, 0.0122, 0.0123, 0.0123, 0.0123,
          0.0121, 0.0117, 0.0111, 0.0100, 0.0080, 0.0045),
        T(0.0038, 0.0068, 0.0086, 0.0095, 0.0098, 0.0099, 0.0099, 0.0098,
          0.0096, 0.0093, 0.0089, 0.0081, 0.0065, 0.0037),
        T(0.0022, 0.0038, 0.0048, 0.0053, 0.0056, 0.0056, 0.0056, 0.0055,
          0.0054, 0.0053, 0.0050, 0.0047, 0.0038, 0.0022)),
      T(T(0.0025, 0.0044, 0.0056, 0.0062, 0.0064, 0.0062, 0.0059, 0.0056,
        0.0054, 0.0055, 0.0055, 0.0052, 0.0043, 0.0025),
        T(0.0042, 0.0076, 0.0097, 0.0107, 0.0110, 0.0107, 0.0101, 0.0096,
          0.0094, 0.0094, 0.0095, 0.0090, 0.0074, 0.0043),
        T(0.0051, 0.0091, 0.0116, 0.0129, 0.0132, 0.0128, 0.0122, 0.0116,
          0.0114, 0.0114, 0.0114, 0.0109, 0.0090, 0.0052),
        T(0.0053, 0.0094, 0.0119, 0.0132, 0.0135, 0.0133, 0.0127, 0.0122,
          0.0119, 0.0119, 0.0119, 0.0114, 0.0094, 0.0055),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0131, 0.0130, 0.0127, 0.0124,
          0.0121, 0.0119, 0.0118, 0.0112, 0.0093, 0.0054),
        T(0.0052, 0.0091, 0.0114, 0.0123, 0.0126, 0.0127, 0.0126, 0.0124,
          0.0121, 0.0118, 0.0116, 0.0110, 0.0091, 0.0053),
        T(0.0052, 0.0091, 0.0113, 0.0122, 0.0124, 0.0125, 0.0125, 0.0124,
          0.0122, 0.0119, 0.0116, 0.0108, 0.0089, 0.0052),
        T(0.0053, 0.0092, 0.0115, 0.0123, 0.0125, 0.0125, 0.0126, 0.0126,
          0.0124, 0.0122, 0.0117, 0.0109, 0.0088, 0.0051),
        T(0.0053, 0.0094, 0.0117, 0.0125, 0.0127, 0.0127, 0.0127, 0.0128,
          0.0128, 0.0125, 0.0120, 0.0109, 0.0087, 0.0050),
        T(0.0054, 0.0095, 0.0118, 0.0128, 0.0130, 0.0130, 0.0130, 0.0131,
          0.0131, 0.0128, 0.0122, 0.0109, 0.0086, 0.0049),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0130, 0.0130, 0.0131, 0.0131,
          0.0131, 0.0127, 0.0120, 0.0107, 0.0085, 0.0048),
        T(0.0048, 0.0086, 0.0108, 0.0118, 0.0122, 0.0123, 0.0123, 0.0123,
          0.0121, 0.0117, 0.0111, 0.0100, 0.0080, 0.0045),
        T(0.0038, 0.0068, 0.0086, 0.0095, 0.0098, 0.0099, 0.0099, 0.0098,
          0.0096, 0.0093, 0.0089, 0.0081, 0.0065, 0.0037),
        T(0.0022, 0.0038, 0.0048, 0.0053, 0.0056, 0.0056, 0.0056, 0.0055,
          0.0054, 0.0053, 0.0050, 0.0047, 0.0038, 0.0022)),
      T(T(0.0025, 0.0044, 0.0056, 0.0062, 0.0064, 0.0062, 0.0059, 0.0056,
        0.0054, 0.0055, 0.0055, 0.0052, 0.0043, 0.0025),
        T(0.0042, 0.0076, 0.0097, 0.0107, 0.0110, 0.0107, 0.0101, 0.0096,
          0.0094, 0.0094, 0.0095, 0.0090, 0.0074, 0.0043),
        T(0.0051, 0.0091, 0.0116, 0.0129, 0.0132, 0.0128, 0.0122, 0.0116,
          0.0114, 0.0114, 0.0114, 0.0109, 0.0090, 0.0052),
        T(0.0053, 0.0094, 0.0119, 0.0132, 0.0135, 0.0133, 0.0127, 0.0122,
          0.0119, 0.0119, 0.0119, 0.0114, 0.0094, 0.0055),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0131, 0.0130, 0.0127, 0.0124,
          0.0121, 0.0119, 0.0118, 0.0112, 0.0093, 0.0054),
        T(0.0052, 0.0091, 0.0114, 0.0123, 0.0126, 0.0127, 0.0126, 0.0124,
          0.0121, 0.0118, 0.0116, 0.0110, 0.0091, 0.0053),
        T(0.0052, 0.0091, 0.0113, 0.0122, 0.0124, 0.0125, 0.0125, 0.0124,
          0.0122, 0.0119, 0.0116, 0.0108, 0.0089, 0.0052),
        T(0.0053, 0.0092, 0.0115, 0.0123, 0.0125, 0.0125, 0.0126, 0.0126,
          0.0124, 0.0122, 0.0117, 0.0109, 0.0088, 0.0051),
        T(0.0053, 0.0094, 0.0117, 0.0125, 0.0127, 0.0127, 0.0127, 0.0128,
          0.0128, 0.0125, 0.0120, 0.0109, 0.0087, 0.0050),
        T(0.0054, 0.0095, 0.0118, 0.0128, 0.0130, 0.0130, 0.0130, 0.0131,
          0.0131, 0.0128, 0.0122, 0.0109, 0.0086, 0.0049),
        T(0.0052, 0.0093, 0.0117, 0.0127, 0.0130, 0.0130, 0.0131, 0.0131,
          0.0131, 0.0127, 0.0120, 0.0107, 0.0085, 0.0048),
        T(0.0048, 0.0086, 0.0108, 0.0118, 0.0122, 0.0123, 0.0123, 0.0123,
          0.0121, 0.0117, 0.0111, 0.0100, 0.0080, 0.0045),
        T(0.0038, 0.0068, 0.0086, 0.0095, 0.0098, 0.0099, 0.0099, 0.0098,
          0.0096, 0.0093, 0.0089, 0.0081, 0.0065, 0.0037),
        T(0.0022, 0.0038, 0.0048, 0.0053, 0.0056, 0.0056, 0.0056, 0.0055,
          0.0054, 0.0053, 0.0050, 0.0047, 0.0038, 0.0022))),
      T(T(T(0.0025, 0.0043, 0.0052, 0.0054, 0.0055, 0.0056, 0.0058, 0.0059,
        0.0059, 0.0058, 0.0056, 0.0053, 0.0044, 0.0025),
        T(0.0044, 0.0075, 0.0089, 0.0094, 0.0095, 0.0097, 0.0100, 0.0101,
          0.0100, 0.0098, 0.0097, 0.0091, 0.0075, 0.0044),
        T(0.0053, 0.0091, 0.0109, 0.0115, 0.0117, 0.0119, 0.0122, 0.0121,
          0.0120, 0.0117, 0.0116, 0.0110, 0.0091, 0.0053),
        T(0.0056, 0.0096, 0.0116, 0.0122, 0.0125, 0.0127, 0.0128, 0.0127,
          0.0124, 0.0122, 0.0120, 0.0114, 0.0095, 0.0055),
        T(0.0055, 0.0095, 0.0116, 0.0123, 0.0127, 0.0128, 0.0129, 0.0127,
          0.0124, 0.0122, 0.0120, 0.0114, 0.0094, 0.0055),
        T(0.0054, 0.0093, 0.0114, 0.0122, 0.0125, 0.0127, 0.0127, 0.0125,
          0.0123, 0.0121, 0.0121, 0.0115, 0.0095, 0.0055),
        T(0.0053, 0.0091, 0.0112, 0.0120, 0.0124, 0.0125, 0.0125, 0.0123,
          0.0122, 0.0122, 0.0123, 0.0117, 0.0096, 0.0055),
        T(0.0052, 0.0090, 0.0110, 0.0119, 0.0122, 0.0123, 0.0122, 0.0121,
          0.0121, 0.0123, 0.0124, 0.0118, 0.0097, 0.0056),
        T(0.0052, 0.0090, 0.0111, 0.0119, 0.0121, 0.0122, 0.0121, 0.0121,
          0.0122, 0.0125, 0.0125, 0.0119, 0.0097, 0.0055),
        T(0.0052, 0.0091, 0.0112, 0.0119, 0.0121, 0.0120, 0.0120, 0.0120,
          0.0123, 0.0126, 0.0126, 0.0119, 0.0096, 0.0055),
        T(0.0051, 0.0090, 0.0110, 0.0118, 0.0119, 0.0118, 0.0117, 0.0118,
          0.0121, 0.0125, 0.0125, 0.0118, 0.0095, 0.0054),
        T(0.0047, 0.0083, 0.0103, 0.0110, 0.0111, 0.0110, 0.0109, 0.0110,
          0.0113, 0.0117, 0.0118, 0.0111, 0.0090, 0.0051),
        T(0.0038, 0.0066, 0.0083, 0.0089, 0.0091, 0.0089, 0.0088, 0.0088,
          0.0091, 0.0095, 0.0096, 0.0091, 0.0074, 0.0042),
        T(0.0021, 0.0037, 0.0047, 0.0051, 0.0052, 0.0051, 0.0050, 0.0050,
          0.0052, 0.0054, 0.0055, 0.0052, 0.0043, 0.0025)),
        T(T(0.0025, 0.0043, 0.0052, 0.0054, 0.0055, 0.0056, 0.0058, 0.0059,
          0.0059, 0.0058, 0.0056, 0.0053, 0.0044, 0.0025),
          T(0.0044, 0.0075, 0.0089, 0.0094, 0.0095, 0.0097, 0.0100, 0.0101,
            0.0100, 0.0098, 0.0097, 0.0091, 0.0075, 0.0044),
          T(0.0053, 0.0091, 0.0109, 0.0115, 0.0117, 0.0119, 0.0122, 0.0121,
            0.0120, 0.0117, 0.0116, 0.0110, 0.0091, 0.0053),
          T(0.0056, 0.0096, 0.0116, 0.0122, 0.0125, 0.0127, 0.0128, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0095, 0.0055),
          T(0.0055, 0.0095, 0.0116, 0.0123, 0.0127, 0.0128, 0.0129, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0094, 0.0055),
          T(0.0054, 0.0093, 0.0114, 0.0122, 0.0125, 0.0127, 0.0127, 0.0125,
            0.0123, 0.0121, 0.0121, 0.0115, 0.0095, 0.0055),
          T(0.0053, 0.0091, 0.0112, 0.0120, 0.0124, 0.0125, 0.0125, 0.0123,
            0.0122, 0.0122, 0.0123, 0.0117, 0.0096, 0.0055),
          T(0.0052, 0.0090, 0.0110, 0.0119, 0.0122, 0.0123, 0.0122, 0.0121,
            0.0121, 0.0123, 0.0124, 0.0118, 0.0097, 0.0056),
          T(0.0052, 0.0090, 0.0111, 0.0119, 0.0121, 0.0122, 0.0121, 0.0121,
            0.0122, 0.0125, 0.0125, 0.0119, 0.0097, 0.0055),
          T(0.0052, 0.0091, 0.0112, 0.0119, 0.0121, 0.0120, 0.0120, 0.0120,
            0.0123, 0.0126, 0.0126, 0.0119, 0.0096, 0.0055),
          T(0.0051, 0.0090, 0.0110, 0.0118, 0.0119, 0.0118, 0.0117, 0.0118,
            0.0121, 0.0125, 0.0125, 0.0118, 0.0095, 0.0054),
          T(0.0047, 0.0083, 0.0103, 0.0110, 0.0111, 0.0110, 0.0109, 0.0110,
            0.0113, 0.0117, 0.0118, 0.0111, 0.0090, 0.0051),
          T(0.0038, 0.0066, 0.0083, 0.0089, 0.0091, 0.0089, 0.0088, 0.0088,
            0.0091, 0.0095, 0.0096, 0.0091, 0.0074, 0.0042),
          T(0.0021, 0.0037, 0.0047, 0.0051, 0.0052, 0.0051, 0.0050, 0.0050,
            0.0052, 0.0054, 0.0055, 0.0052, 0.0043, 0.0025)),
        T(T(0.0025, 0.0043, 0.0052, 0.0054, 0.0055, 0.0056, 0.0058, 0.0059,
          0.0059, 0.0058, 0.0056, 0.0053, 0.0044, 0.0025),
          T(0.0044, 0.0075, 0.0089, 0.0094, 0.0095, 0.0097, 0.0100, 0.0101,
            0.0100, 0.0098, 0.0097, 0.0091, 0.0075, 0.0044),
          T(0.0053, 0.0091, 0.0109, 0.0115, 0.0117, 0.0119, 0.0122, 0.0121,
            0.0120, 0.0117, 0.0116, 0.0110, 0.0091, 0.0053),
          T(0.0056, 0.0096, 0.0116, 0.0122, 0.0125, 0.0127, 0.0128, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0095, 0.0055),
          T(0.0055, 0.0095, 0.0116, 0.0123, 0.0127, 0.0128, 0.0129, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0094, 0.0055),
          T(0.0054, 0.0093, 0.0114, 0.0122, 0.0125, 0.0127, 0.0127, 0.0125,
            0.0123, 0.0121, 0.0121, 0.0115, 0.0095, 0.0055),
          T(0.0053, 0.0091, 0.0112, 0.0120, 0.0124, 0.0125, 0.0125, 0.0123,
            0.0122, 0.0122, 0.0123, 0.0117, 0.0096, 0.0055),
          T(0.0052, 0.0090, 0.0110, 0.0119, 0.0122, 0.0123, 0.0122, 0.0121,
            0.0121, 0.0123, 0.0124, 0.0118, 0.0097, 0.0056),
          T(0.0052, 0.0090, 0.0111, 0.0119, 0.0121, 0.0122, 0.0121, 0.0121,
            0.0122, 0.0125, 0.0125, 0.0119, 0.0097, 0.0055),
          T(0.0052, 0.0091, 0.0112, 0.0119, 0.0121, 0.0120, 0.0120, 0.0120,
            0.0123, 0.0126, 0.0126, 0.0119, 0.0096, 0.0055),
          T(0.0051, 0.0090, 0.0110, 0.0118, 0.0119, 0.0118, 0.0117, 0.0118,
            0.0121, 0.0125, 0.0125, 0.0118, 0.0095, 0.0054),
          T(0.0047, 0.0083, 0.0103, 0.0110, 0.0111, 0.0110, 0.0109, 0.0110,
            0.0113, 0.0117, 0.0118, 0.0111, 0.0090, 0.0051),
          T(0.0038, 0.0066, 0.0083, 0.0089, 0.0091, 0.0089, 0.0088, 0.0088,
            0.0091, 0.0095, 0.0096, 0.0091, 0.0074, 0.0042),
          T(0.0021, 0.0037, 0.0047, 0.0051, 0.0052, 0.0051, 0.0050, 0.0050,
            0.0052, 0.0054, 0.0055, 0.0052, 0.0043, 0.0025)),
        T(T(0.0025, 0.0043, 0.0052, 0.0054, 0.0055, 0.0056, 0.0058, 0.0059,
          0.0059, 0.0058, 0.0056, 0.0053, 0.0044, 0.0025),
          T(0.0044, 0.0075, 0.0089, 0.0094, 0.0095, 0.0097, 0.0100, 0.0101,
            0.0100, 0.0098, 0.0097, 0.0091, 0.0075, 0.0044),
          T(0.0053, 0.0091, 0.0109, 0.0115, 0.0117, 0.0119, 0.0122, 0.0121,
            0.0120, 0.0117, 0.0116, 0.0110, 0.0091, 0.0053),
          T(0.0056, 0.0096, 0.0116, 0.0122, 0.0125, 0.0127, 0.0128, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0095, 0.0055),
          T(0.0055, 0.0095, 0.0116, 0.0123, 0.0127, 0.0128, 0.0129, 0.0127,
            0.0124, 0.0122, 0.0120, 0.0114, 0.0094, 0.0055),
          T(0.0054, 0.0093, 0.0114, 0.0122, 0.0125, 0.0127, 0.0127, 0.0125,
            0.0123, 0.0121, 0.0121, 0.0115, 0.0095, 0.0055),
          T(0.0053, 0.0091, 0.0112, 0.0120, 0.0124, 0.0125, 0.0125, 0.0123,
            0.0122, 0.0122, 0.0123, 0.0117, 0.0096, 0.0055),
          T(0.0052, 0.0090, 0.0110, 0.0119, 0.0122, 0.0123, 0.0122, 0.0121,
            0.0121, 0.0123, 0.0124, 0.0118, 0.0097, 0.0056),
          T(0.0052, 0.0090, 0.0111, 0.0119, 0.0121, 0.0122, 0.0121, 0.0121,
            0.0122, 0.0125, 0.0125, 0.0119, 0.0097, 0.0055),
          T(0.0052, 0.0091, 0.0112, 0.0119, 0.0121, 0.0120, 0.0120, 0.0120,
            0.0123, 0.0126, 0.0126, 0.0119, 0.0096, 0.0055),
          T(0.0051, 0.0090, 0.0110, 0.0118, 0.0119, 0.0118, 0.0117, 0.0118,
            0.0121, 0.0125, 0.0125, 0.0118, 0.0095, 0.0054),
          T(0.0047, 0.0083, 0.0103, 0.0110, 0.0111, 0.0110, 0.0109, 0.0110,
            0.0113, 0.0117, 0.0118, 0.0111, 0.0090, 0.0051),
          T(0.0038, 0.0066, 0.0083, 0.0089, 0.0091, 0.0089, 0.0088, 0.0088,
            0.0091, 0.0095, 0.0096, 0.0091, 0.0074, 0.0042),
          T(0.0021, 0.0037, 0.0047, 0.0051, 0.0052, 0.0051, 0.0050, 0.0050,
            0.0052, 0.0054, 0.0055, 0.0052, 0.0043, 0.0025)))))

    val output = layer.forward(input).toTensor[Float]

    output.almostEqual(expectedOutput, 1e-4) should be(true)
  }

  "all" should "be ok" in {
    val resolution = 14
    val scales = Array[Float](0.25f, 0.125f)
    val sampling_ratio = 2
    val in_channels = 6
    val use_gn = false
    val layers = Array[Int](4, 4)
    val dilation = 1

    val layer = new MaskRCNNFPNFeatureExtractor(in_channels, resolution, scales,
      sampling_ratio, layers, dilation, use_gn)

    val paramsTable = layer.getParametersTable()
    for (i <- paramsTable.keySet) {
      val params = paramsTable.get[Table](i).get.get[Tensor[Float]]("weight").get
      params.fill(0.01f)
    }

    val features1 = Tensor[Float](T(T(T(T(0.5381, 0.0856, 0.1124, 0.7493),
      T(0.4624, 0.2182, 0.7364, 0.3522),
      T(0.7552, 0.7117, 0.2715, 0.9082)),
      T(T(0.0928, 0.2735, 0.7539, 0.7539),
        T(0.4777, 0.1525, 0.8279, 0.6481),
        T(0.6019, 0.4803, 0.5869, 0.7459)),
      T(T(0.1924, 0.2795, 0.4463, 0.3887),
        T(0.5791, 0.9832, 0.8752, 0.4598),
        T(0.2278, 0.0758, 0.4988, 0.3742)),
      T(T(0.1762, 0.6499, 0.2534, 0.9842),
        T(0.0908, 0.8676, 0.1700, 0.1887),
        T(0.7138, 0.9559, 0.0119, 0.7799)),
      T(T(0.8200, 0.6767, 0.3637, 0.9771),
        T(0.1217, 0.5645, 0.2574, 0.6729),
        T(0.6140, 0.5333, 0.4425, 0.1740)),
      T(T(0.3994, 0.9148, 0.0123, 0.0125),
        T(0.5663, 0.9951, 0.8143, 0.9906),
        T(0.0923, 0.8285, 0.2992, 0.2221)))))

    val features2 = Tensor[Float](T(T(T(T(0.0492, 0.1234),
      T(0.3291, 0.0613),
      T(0.4260, 0.1422),
      T(0.2282, 0.4258),
      T(0.7426, 0.9476)),
      T(T(0.6662, 0.7015),
        T(0.4598, 0.6378),
        T(0.9571, 0.4947),
        T(0.1659, 0.3034),
        T(0.8583, 0.1369)),
      T(T(0.1711, 0.6440),
        T(0.2099, 0.4468),
        T(0.9518, 0.3877),
        T(0.4058, 0.6630),
        T(0.9056, 0.4054)),
      T(T(0.4562, 0.0277),
        T(0.2358, 0.3938),
        T(0.9187, 0.4067),
        T(0.0445, 0.4171),
        T(0.3434, 0.1964)),
      T(T(0.9473, 0.7239),
        T(0.1732, 0.5352),
        T(0.8276, 0.6435),
        T(0.3516, 0.3760),
        T(0.3437, 0.0198)),
      T(T(0.7811, 0.5682),
        T(0.5121, 0.9655),
        T(0.3496, 0.7632),
        T(0.4267, 0.4533),
        T(0.8624, 0.3172)))))

    val bbox = Tensor[Float](T(T(1.0f, 3.0f, 2.0f, 6.0f),
      T(3.0f, 5.0f, 6.0f, 10.0f)))

    val expectedOutput = Tensor[Float](T(T(T(
      T(0.0275, 0.0447, 0.0516, 0.0533, 0.0551, 0.0568, 0.0585, 0.0603,
      0.0620, 0.0635, 0.0645, 0.0649, 0.0577, 0.0360),
      T(0.0442, 0.0718, 0.0829, 0.0858, 0.0886, 0.0914, 0.0943, 0.0971,
        0.0999, 0.1023, 0.1040, 0.1047, 0.0932, 0.0582),
      T(0.0501, 0.0814, 0.0940, 0.0973, 0.1005, 0.1038, 0.1070, 0.1103,
        0.1135, 0.1163, 0.1183, 0.1191, 0.1060, 0.0662),
      T(0.0505, 0.0822, 0.0949, 0.0982, 0.1015, 0.1048, 0.1081, 0.1114,
        0.1146, 0.1175, 0.1195, 0.1204, 0.1071, 0.0669),
      T(0.0510, 0.0830, 0.0958, 0.0990, 0.1022, 0.1055, 0.1087, 0.1120,
        0.1152, 0.1179, 0.1199, 0.1207, 0.1073, 0.0670),
      T(0.0515, 0.0837, 0.0965, 0.0997, 0.1028, 0.1059, 0.1090, 0.1122,
        0.1153, 0.1179, 0.1197, 0.1203, 0.1069, 0.0667),
      T(0.0521, 0.0845, 0.0973, 0.1003, 0.1032, 0.1062, 0.1092, 0.1122,
        0.1151, 0.1176, 0.1193, 0.1197, 0.1062, 0.0662),
      T(0.0526, 0.0852, 0.0980, 0.1008, 0.1037, 0.1065, 0.1094, 0.1122,
        0.1150, 0.1173, 0.1188, 0.1190, 0.1055, 0.0657),
      T(0.0531, 0.0860, 0.0988, 0.1014, 0.1041, 0.1068, 0.1095, 0.1122,
        0.1148, 0.1170, 0.1183, 0.1183, 0.1047, 0.0651),
      T(0.0536, 0.0867, 0.0995, 0.1020, 0.1046, 0.1071, 0.1096, 0.1122,
        0.1147, 0.1167, 0.1178, 0.1176, 0.1039, 0.0646),
      T(0.0541, 0.0875, 0.1002, 0.1026, 0.1050, 0.1074, 0.1098, 0.1122,
        0.1145, 0.1164, 0.1173, 0.1169, 0.1032, 0.0641),
      T(0.0546, 0.0883, 0.1010, 0.1032, 0.1055, 0.1077, 0.1099, 0.1122,
        0.1143, 0.1161, 0.1168, 0.1162, 0.1024, 0.0635),
      T(0.0489, 0.0790, 0.0903, 0.0921, 0.0940, 0.0959, 0.0978, 0.0997,
        0.1015, 0.1029, 0.1035, 0.1029, 0.0905, 0.0561),
      T(0.0307, 0.0495, 0.0566, 0.0577, 0.0589, 0.0600, 0.0612, 0.0623,
        0.0634, 0.0643, 0.0646, 0.0641, 0.0564, 0.0349)),

      T(T(0.0275, 0.0447, 0.0516, 0.0533, 0.0551, 0.0568, 0.0585, 0.0603,
        0.0620, 0.0635, 0.0645, 0.0649, 0.0577, 0.0360),
        T(0.0442, 0.0718, 0.0829, 0.0858, 0.0886, 0.0914, 0.0943, 0.0971,
          0.0999, 0.1023, 0.1040, 0.1047, 0.0932, 0.0582),
        T(0.0501, 0.0814, 0.0940, 0.0973, 0.1005, 0.1038, 0.1070, 0.1103,
          0.1135, 0.1163, 0.1183, 0.1191, 0.1060, 0.0662),
        T(0.0505, 0.0822, 0.0949, 0.0982, 0.1015, 0.1048, 0.1081, 0.1114,
          0.1146, 0.1175, 0.1195, 0.1204, 0.1071, 0.0669),
        T(0.0510, 0.0830, 0.0958, 0.0990, 0.1022, 0.1055, 0.1087, 0.1120,
          0.1152, 0.1179, 0.1199, 0.1207, 0.1073, 0.0670),
        T(0.0515, 0.0837, 0.0965, 0.0997, 0.1028, 0.1059, 0.1090, 0.1122,
          0.1153, 0.1179, 0.1197, 0.1203, 0.1069, 0.0667),
        T(0.0521, 0.0845, 0.0973, 0.1003, 0.1032, 0.1062, 0.1092, 0.1122,
          0.1151, 0.1176, 0.1193, 0.1197, 0.1062, 0.0662),
        T(0.0526, 0.0852, 0.0980, 0.1008, 0.1037, 0.1065, 0.1094, 0.1122,
          0.1150, 0.1173, 0.1188, 0.1190, 0.1055, 0.0657),
        T(0.0531, 0.0860, 0.0988, 0.1014, 0.1041, 0.1068, 0.1095, 0.1122,
          0.1148, 0.1170, 0.1183, 0.1183, 0.1047, 0.0651),
        T(0.0536, 0.0867, 0.0995, 0.1020, 0.1046, 0.1071, 0.1096, 0.1122,
          0.1147, 0.1167, 0.1178, 0.1176, 0.1039, 0.0646),
        T(0.0541, 0.0875, 0.1002, 0.1026, 0.1050, 0.1074, 0.1098, 0.1122,
          0.1145, 0.1164, 0.1173, 0.1169, 0.1032, 0.0641),
        T(0.0546, 0.0883, 0.1010, 0.1032, 0.1055, 0.1077, 0.1099, 0.1122,
          0.1143, 0.1161, 0.1168, 0.1162, 0.1024, 0.0635),
        T(0.0489, 0.0790, 0.0903, 0.0921, 0.0940, 0.0959, 0.0978, 0.0997,
          0.1015, 0.1029, 0.1035, 0.1029, 0.0905, 0.0561),
        T(0.0307, 0.0495, 0.0566, 0.0577, 0.0589, 0.0600, 0.0612, 0.0623,
          0.0634, 0.0643, 0.0646, 0.0641, 0.0564, 0.0349)),

      T(T(0.0275, 0.0447, 0.0516, 0.0533, 0.0551, 0.0568, 0.0585, 0.0603,
        0.0620, 0.0635, 0.0645, 0.0649, 0.0577, 0.0360),
        T(0.0442, 0.0718, 0.0829, 0.0858, 0.0886, 0.0914, 0.0943, 0.0971,
          0.0999, 0.1023, 0.1040, 0.1047, 0.0932, 0.0582),
        T(0.0501, 0.0814, 0.0940, 0.0973, 0.1005, 0.1038, 0.1070, 0.1103,
          0.1135, 0.1163, 0.1183, 0.1191, 0.1060, 0.0662),
        T(0.0505, 0.0822, 0.0949, 0.0982, 0.1015, 0.1048, 0.1081, 0.1114,
          0.1146, 0.1175, 0.1195, 0.1204, 0.1071, 0.0669),
        T(0.0510, 0.0830, 0.0958, 0.0990, 0.1022, 0.1055, 0.1087, 0.1120,
          0.1152, 0.1179, 0.1199, 0.1207, 0.1073, 0.0670),
        T(0.0515, 0.0837, 0.0965, 0.0997, 0.1028, 0.1059, 0.1090, 0.1122,
          0.1153, 0.1179, 0.1197, 0.1203, 0.1069, 0.0667),
        T(0.0521, 0.0845, 0.0973, 0.1003, 0.1032, 0.1062, 0.1092, 0.1122,
          0.1151, 0.1176, 0.1193, 0.1197, 0.1062, 0.0662),
        T(0.0526, 0.0852, 0.0980, 0.1008, 0.1037, 0.1065, 0.1094, 0.1122,
          0.1150, 0.1173, 0.1188, 0.1190, 0.1055, 0.0657),
        T(0.0531, 0.0860, 0.0988, 0.1014, 0.1041, 0.1068, 0.1095, 0.1122,
          0.1148, 0.1170, 0.1183, 0.1183, 0.1047, 0.0651),
        T(0.0536, 0.0867, 0.0995, 0.1020, 0.1046, 0.1071, 0.1096, 0.1122,
          0.1147, 0.1167, 0.1178, 0.1176, 0.1039, 0.0646),
        T(0.0541, 0.0875, 0.1002, 0.1026, 0.1050, 0.1074, 0.1098, 0.1122,
          0.1145, 0.1164, 0.1173, 0.1169, 0.1032, 0.0641),
        T(0.0546, 0.0883, 0.1010, 0.1032, 0.1055, 0.1077, 0.1099, 0.1122,
          0.1143, 0.1161, 0.1168, 0.1162, 0.1024, 0.0635),
        T(0.0489, 0.0790, 0.0903, 0.0921, 0.0940, 0.0959, 0.0978, 0.0997,
          0.1015, 0.1029, 0.1035, 0.1029, 0.0905, 0.0561),
        T(0.0307, 0.0495, 0.0566, 0.0577, 0.0589, 0.0600, 0.0612, 0.0623,
          0.0634, 0.0643, 0.0646, 0.0641, 0.0564, 0.0349)),

      T(T(0.0275, 0.0447, 0.0516, 0.0533, 0.0551, 0.0568, 0.0585, 0.0603,
        0.0620, 0.0635, 0.0645, 0.0649, 0.0577, 0.0360),
        T(0.0442, 0.0718, 0.0829, 0.0858, 0.0886, 0.0914, 0.0943, 0.0971,
          0.0999, 0.1023, 0.1040, 0.1047, 0.0932, 0.0582),
        T(0.0501, 0.0814, 0.0940, 0.0973, 0.1005, 0.1038, 0.1070, 0.1103,
          0.1135, 0.1163, 0.1183, 0.1191, 0.1060, 0.0662),
        T(0.0505, 0.0822, 0.0949, 0.0982, 0.1015, 0.1048, 0.1081, 0.1114,
          0.1146, 0.1175, 0.1195, 0.1204, 0.1071, 0.0669),
        T(0.0510, 0.0830, 0.0958, 0.0990, 0.1022, 0.1055, 0.1087, 0.1120,
          0.1152, 0.1179, 0.1199, 0.1207, 0.1073, 0.0670),
        T(0.0515, 0.0837, 0.0965, 0.0997, 0.1028, 0.1059, 0.1090, 0.1122,
          0.1153, 0.1179, 0.1197, 0.1203, 0.1069, 0.0667),
        T(0.0521, 0.0845, 0.0973, 0.1003, 0.1032, 0.1062, 0.1092, 0.1122,
          0.1151, 0.1176, 0.1193, 0.1197, 0.1062, 0.0662),
        T(0.0526, 0.0852, 0.0980, 0.1008, 0.1037, 0.1065, 0.1094, 0.1122,
          0.1150, 0.1173, 0.1188, 0.1190, 0.1055, 0.0657),
        T(0.0531, 0.0860, 0.0988, 0.1014, 0.1041, 0.1068, 0.1095, 0.1122,
          0.1148, 0.1170, 0.1183, 0.1183, 0.1047, 0.0651),
        T(0.0536, 0.0867, 0.0995, 0.1020, 0.1046, 0.1071, 0.1096, 0.1122,
          0.1147, 0.1167, 0.1178, 0.1176, 0.1039, 0.0646),
        T(0.0541, 0.0875, 0.1002, 0.1026, 0.1050, 0.1074, 0.1098, 0.1122,
          0.1145, 0.1164, 0.1173, 0.1169, 0.1032, 0.0641),
        T(0.0546, 0.0883, 0.1010, 0.1032, 0.1055, 0.1077, 0.1099, 0.1122,
          0.1143, 0.1161, 0.1168, 0.1162, 0.1024, 0.0635),
        T(0.0489, 0.0790, 0.0903, 0.0921, 0.0940, 0.0959, 0.0978, 0.0997,
          0.1015, 0.1029, 0.1035, 0.1029, 0.0905, 0.0561),
        T(0.0307, 0.0495, 0.0566, 0.0577, 0.0589, 0.0600, 0.0612, 0.0623,
          0.0634, 0.0643, 0.0646, 0.0641, 0.0564, 0.0349))),


      T(T(T(0.0353, 0.0570, 0.0650, 0.0657, 0.0657, 0.0652, 0.0644, 0.0637,
        0.0629, 0.0621, 0.0613, 0.0606, 0.0533, 0.0331),
        T(0.0564, 0.0911, 0.1038, 0.1048, 0.1047, 0.1038, 0.1025, 0.1012,
          0.0998, 0.0985, 0.0971, 0.0958, 0.0842, 0.0523),
        T(0.0634, 0.1024, 0.1165, 0.1175, 0.1172, 0.1160, 0.1143, 0.1126,
          0.1108, 0.1091, 0.1074, 0.1056, 0.0927, 0.0575),
        T(0.0633, 0.1022, 0.1161, 0.1169, 0.1163, 0.1148, 0.1129, 0.1109,
          0.1088, 0.1068, 0.1048, 0.1028, 0.0900, 0.0557),
        T(0.0632, 0.1019, 0.1157, 0.1162, 0.1155, 0.1137, 0.1115, 0.1092,
          0.1069, 0.1045, 0.1022, 0.0999, 0.0873, 0.0540),
        T(0.0631, 0.1017, 0.1153, 0.1156, 0.1146, 0.1126, 0.1100, 0.1075,
          0.1049, 0.1023, 0.0997, 0.0971, 0.0846, 0.0522),
        T(0.0631, 0.1015, 0.1149, 0.1150, 0.1138, 0.1115, 0.1087, 0.1058,
          0.1029, 0.1000, 0.0972, 0.0943, 0.0819, 0.0505),
        T(0.0630, 0.1013, 0.1146, 0.1145, 0.1130, 0.1105, 0.1074, 0.1043,
          0.1012, 0.0981, 0.0950, 0.0919, 0.0796, 0.0490),
        T(0.0629, 0.1012, 0.1143, 0.1141, 0.1125, 0.1098, 0.1065, 0.1033,
          0.1000, 0.0967, 0.0934, 0.0901, 0.0779, 0.0479),
        T(0.0629, 0.1011, 0.1142, 0.1139, 0.1122, 0.1094, 0.1061, 0.1027,
          0.0993, 0.0960, 0.0926, 0.0892, 0.0770, 0.0473),
        T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
          0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
        T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
          0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
        T(0.0559, 0.0899, 0.1015, 0.1012, 0.0996, 0.0971, 0.0942, 0.0911,
          0.0881, 0.0851, 0.0820, 0.0790, 0.0682, 0.0419),
        T(0.0349, 0.0562, 0.0634, 0.0633, 0.0623, 0.0607, 0.0588, 0.0570,
          0.0551, 0.0532, 0.0513, 0.0494, 0.0426, 0.0262)),

        T(T(0.0353, 0.0570, 0.0650, 0.0657, 0.0657, 0.0652, 0.0644, 0.0637,
          0.0629, 0.0621, 0.0613, 0.0606, 0.0533, 0.0331),
          T(0.0564, 0.0911, 0.1038, 0.1048, 0.1047, 0.1038, 0.1025, 0.1012,
            0.0998, 0.0985, 0.0971, 0.0958, 0.0842, 0.0523),
          T(0.0634, 0.1024, 0.1165, 0.1175, 0.1172, 0.1160, 0.1143, 0.1126,
            0.1108, 0.1091, 0.1074, 0.1056, 0.0927, 0.0575),
          T(0.0633, 0.1022, 0.1161, 0.1169, 0.1163, 0.1148, 0.1129, 0.1109,
            0.1088, 0.1068, 0.1048, 0.1028, 0.0900, 0.0557),
          T(0.0632, 0.1019, 0.1157, 0.1162, 0.1155, 0.1137, 0.1115, 0.1092,
            0.1069, 0.1045, 0.1022, 0.0999, 0.0873, 0.0540),
          T(0.0631, 0.1017, 0.1153, 0.1156, 0.1146, 0.1126, 0.1100, 0.1075,
            0.1049, 0.1023, 0.0997, 0.0971, 0.0846, 0.0522),
          T(0.0631, 0.1015, 0.1149, 0.1150, 0.1138, 0.1115, 0.1087, 0.1058,
            0.1029, 0.1000, 0.0972, 0.0943, 0.0819, 0.0505),
          T(0.0630, 0.1013, 0.1146, 0.1145, 0.1130, 0.1105, 0.1074, 0.1043,
            0.1012, 0.0981, 0.0950, 0.0919, 0.0796, 0.0490),
          T(0.0629, 0.1012, 0.1143, 0.1141, 0.1125, 0.1098, 0.1065, 0.1033,
            0.1000, 0.0967, 0.0934, 0.0901, 0.0779, 0.0479),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1122, 0.1094, 0.1061, 0.1027,
            0.0993, 0.0960, 0.0926, 0.0892, 0.0770, 0.0473),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0559, 0.0899, 0.1015, 0.1012, 0.0996, 0.0971, 0.0942, 0.0911,
            0.0881, 0.0851, 0.0820, 0.0790, 0.0682, 0.0419),
          T(0.0349, 0.0562, 0.0634, 0.0633, 0.0623, 0.0607, 0.0588, 0.0570,
            0.0551, 0.0532, 0.0513, 0.0494, 0.0426, 0.0262)),

        T(T(0.0353, 0.0570, 0.0650, 0.0657, 0.0657, 0.0652, 0.0644, 0.0637,
          0.0629, 0.0621, 0.0613, 0.0606, 0.0533, 0.0331),
          T(0.0564, 0.0911, 0.1038, 0.1048, 0.1047, 0.1038, 0.1025, 0.1012,
            0.0998, 0.0985, 0.0971, 0.0958, 0.0842, 0.0523),
          T(0.0634, 0.1024, 0.1165, 0.1175, 0.1172, 0.1160, 0.1143, 0.1126,
            0.1108, 0.1091, 0.1074, 0.1056, 0.0927, 0.0575),
          T(0.0633, 0.1022, 0.1161, 0.1169, 0.1163, 0.1148, 0.1129, 0.1109,
            0.1088, 0.1068, 0.1048, 0.1028, 0.0900, 0.0557),
          T(0.0632, 0.1019, 0.1157, 0.1162, 0.1155, 0.1137, 0.1115, 0.1092,
            0.1069, 0.1045, 0.1022, 0.0999, 0.0873, 0.0540),
          T(0.0631, 0.1017, 0.1153, 0.1156, 0.1146, 0.1126, 0.1100, 0.1075,
            0.1049, 0.1023, 0.0997, 0.0971, 0.0846, 0.0522),
          T(0.0631, 0.1015, 0.1149, 0.1150, 0.1138, 0.1115, 0.1087, 0.1058,
            0.1029, 0.1000, 0.0972, 0.0943, 0.0819, 0.0505),
          T(0.0630, 0.1013, 0.1146, 0.1145, 0.1130, 0.1105, 0.1074, 0.1043,
            0.1012, 0.0981, 0.0950, 0.0919, 0.0796, 0.0490),
          T(0.0629, 0.1012, 0.1143, 0.1141, 0.1125, 0.1098, 0.1065, 0.1033,
            0.1000, 0.0967, 0.0934, 0.0901, 0.0779, 0.0479),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1122, 0.1094, 0.1061, 0.1027,
            0.0993, 0.0960, 0.0926, 0.0892, 0.0770, 0.0473),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0559, 0.0899, 0.1015, 0.1012, 0.0996, 0.0971, 0.0942, 0.0911,
            0.0881, 0.0851, 0.0820, 0.0790, 0.0682, 0.0419),
          T(0.0349, 0.0562, 0.0634, 0.0633, 0.0623, 0.0607, 0.0588, 0.0570,
            0.0551, 0.0532, 0.0513, 0.0494, 0.0426, 0.0262)),

        T(T(0.0353, 0.0570, 0.0650, 0.0657, 0.0657, 0.0652, 0.0644, 0.0637,
          0.0629, 0.0621, 0.0613, 0.0606, 0.0533, 0.0331),
          T(0.0564, 0.0911, 0.1038, 0.1048, 0.1047, 0.1038, 0.1025, 0.1012,
            0.0998, 0.0985, 0.0971, 0.0958, 0.0842, 0.0523),
          T(0.0634, 0.1024, 0.1165, 0.1175, 0.1172, 0.1160, 0.1143, 0.1126,
            0.1108, 0.1091, 0.1074, 0.1056, 0.0927, 0.0575),
          T(0.0633, 0.1022, 0.1161, 0.1169, 0.1163, 0.1148, 0.1129, 0.1109,
            0.1088, 0.1068, 0.1048, 0.1028, 0.0900, 0.0557),
          T(0.0632, 0.1019, 0.1157, 0.1162, 0.1155, 0.1137, 0.1115, 0.1092,
            0.1069, 0.1045, 0.1022, 0.0999, 0.0873, 0.0540),
          T(0.0631, 0.1017, 0.1153, 0.1156, 0.1146, 0.1126, 0.1100, 0.1075,
            0.1049, 0.1023, 0.0997, 0.0971, 0.0846, 0.0522),
          T(0.0631, 0.1015, 0.1149, 0.1150, 0.1138, 0.1115, 0.1087, 0.1058,
            0.1029, 0.1000, 0.0972, 0.0943, 0.0819, 0.0505),
          T(0.0630, 0.1013, 0.1146, 0.1145, 0.1130, 0.1105, 0.1074, 0.1043,
            0.1012, 0.0981, 0.0950, 0.0919, 0.0796, 0.0490),
          T(0.0629, 0.1012, 0.1143, 0.1141, 0.1125, 0.1098, 0.1065, 0.1033,
            0.1000, 0.0967, 0.0934, 0.0901, 0.0779, 0.0479),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1122, 0.1094, 0.1061, 0.1027,
            0.0993, 0.0960, 0.0926, 0.0892, 0.0770, 0.0473),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0629, 0.1011, 0.1142, 0.1139, 0.1121, 0.1093, 0.1059, 0.1025,
            0.0991, 0.0957, 0.0923, 0.0889, 0.0767, 0.0471),
          T(0.0559, 0.0899, 0.1015, 0.1012, 0.0996, 0.0971, 0.0942, 0.0911,
            0.0881, 0.0851, 0.0820, 0.0790, 0.0682, 0.0419),
          T(0.0349, 0.0562, 0.0634, 0.0633, 0.0623, 0.0607, 0.0588, 0.0570,
            0.0551, 0.0532, 0.0513, 0.0494, 0.0426, 0.0262)))))

    val output = layer.forward(T(T(features1, features2), bbox)).toTensor[Float]

    output.almostEqual(expectedOutput, 1e-3) should be(true)
  }
}
